<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="project.nyc.taxi">
<title>Data Understanding • project.nyc.taxi</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Open_Sans-0.4.9/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Data Understanding">
<meta property="og:description" content="project.nyc.taxi">
<meta property="og:image" content="https://angelfelizr.github.io/project.nyc.taxi/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">project.nyc.taxi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.99</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/01-data-collection-process.html">Data Collection Process</a>
    <a class="dropdown-item" href="../articles/02-business-understanding.html">Business Understanding</a>
    <a class="dropdown-item" href="../articles/03-data-understanding.html">Data Understanding</a>
    <a class="dropdown-item" href="../articles/project.nyc.taxi.html">Defining Environment</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/AngelFelizR/project.nyc.taxi/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<link href="03-data-understanding_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="03-data-understanding_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="03-data-understanding_files/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="03-data-understanding_files/leaflet-1.3.1/leaflet.js"></script><link href="03-data-understanding_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="03-data-understanding_files/proj4-2.6.2/proj4.min.js"></script><script src="03-data-understanding_files/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="03-data-understanding_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="03-data-understanding_files/leaflet-binding-2.2.2/leaflet.js"></script><script src="03-data-understanding_files/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script><script src="03-data-understanding_files/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Data Understanding</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/AngelFelizR/project.nyc.taxi/blob/HEAD/vignettes/articles/03-data-understanding.Rmd" class="external-link"><code>vignettes/articles/03-data-understanding.Rmd</code></a></small>
      <div class="d-none name"><code>03-data-understanding.Rmd</code></div>
    </div>

    
    
<p>After completing the <a href="https://angelfelizr.github.io/project.nyc.taxi/articles/02-business-understanding.html">business
understanding</a> phase we are ready to perform the <strong>data
understanding</strong> phase by performing an EDA with the following
steps:</p>
<ol style="list-style-type: decimal">
<li>Exploring the individual distribution of variables.</li>
<li>Taking a subset of the data to fit in RAM.</li>
<li>Exploring correlations between predictors and target variable.</li>
<li>Exploring correlations between predictors.</li>
</ol>
<p>In order to:</p>
<ul>
<li>Ensure data quality</li>
<li>Identify key predictors</li>
<li>Detect multicollinearity</li>
<li>Guide model choice and feature engineering</li>
</ul>
<div class="section level2">
<h2 id="setting-the-environment-up">Setting the environment up<a class="anchor" aria-label="anchor" href="#setting-the-environment-up"></a>
</h2>
<p>To setting the <code>R</code> environment up we just need to apply
the following 5 steps:</p>
<ol style="list-style-type: decimal">
<li>Loading the packages to use.</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/" class="external-link">here</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org" class="external-link">scales</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://forcats.tidyverse.org/" class="external-link">forcats</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/apache/arrow/" class="external-link">arrow</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/recipes" class="external-link">recipes</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>datatable.print.nrows <span class="op">=</span> <span class="fl">15</span>,</span>
<span>        digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Creating an Arrow connection object to perform some
<strong>manipulations in disk</strong> before taking the data into the
RAM memory.</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"raw-data/trip-data/year=2022"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">NycTrips2022</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://arrow.apache.org/docs/r/reference/open_dataset.html" class="external-link">open_dataset</a></span><span class="op">(</span><span class="va">data_path</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">NycTrips2022</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://scales.r-lib.org/reference/comma.html" class="external-link">comma</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "212,416,083" "25"</span></span>
<span></span>
<span><span class="va">NycTrips2022</span></span>
<span><span class="co">#&gt; FileSystemDataset with 12 Parquet files</span></span>
<span><span class="co">#&gt; hvfhs_license_num: string</span></span>
<span><span class="co">#&gt; dispatching_base_num: string</span></span>
<span><span class="co">#&gt; originating_base_num: string</span></span>
<span><span class="co">#&gt; request_datetime: timestamp[us]</span></span>
<span><span class="co">#&gt; on_scene_datetime: timestamp[us]</span></span>
<span><span class="co">#&gt; pickup_datetime: timestamp[us]</span></span>
<span><span class="co">#&gt; dropoff_datetime: timestamp[us]</span></span>
<span><span class="co">#&gt; PULocationID: int64</span></span>
<span><span class="co">#&gt; DOLocationID: int64</span></span>
<span><span class="co">#&gt; trip_miles: double</span></span>
<span><span class="co">#&gt; trip_time: int64</span></span>
<span><span class="co">#&gt; base_passenger_fare: double</span></span>
<span><span class="co">#&gt; tolls: double</span></span>
<span><span class="co">#&gt; bcf: double</span></span>
<span><span class="co">#&gt; sales_tax: double</span></span>
<span><span class="co">#&gt; congestion_surcharge: double</span></span>
<span><span class="co">#&gt; airport_fee: double</span></span>
<span><span class="co">#&gt; tips: double</span></span>
<span><span class="co">#&gt; driver_pay: double</span></span>
<span><span class="co">#&gt; shared_request_flag: string</span></span>
<span><span class="co">#&gt; shared_match_flag: string</span></span>
<span><span class="co">#&gt; access_a_ride_flag: string</span></span>
<span><span class="co">#&gt; wav_request_flag: string</span></span>
<span><span class="co">#&gt; wav_match_flag: string</span></span>
<span><span class="co">#&gt; month: int32</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; See $metadata for additional Schema metadata</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Importing the zone code description with <code>lat</code> and
<code>long</code>.</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ZoneCodesArcgis</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"raw-data/taxi_zone_lookup.csv"</span><span class="op">)</span>,</span>
<span>        colClasses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"integer"</span>,</span>
<span>                       <span class="st">"character"</span>,</span>
<span>                       <span class="st">"character"</span>,</span>
<span>                       <span class="st">"character"</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">[</span>, <span class="va">Address</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">Zone</span>,</span>
<span>                       <span class="va">Borough</span>,</span>
<span>                       <span class="st">"New York"</span>,</span>
<span>                       <span class="st">"United States"</span>,</span>
<span>                       sep <span class="op">=</span> <span class="st">", "</span><span class="op">)</span></span>
<span>  <span class="op">]</span><span class="op">[</span>, <span class="fu">tidygeocoder</span><span class="fu">::</span><span class="fu"><a href="https://jessecambon.github.io/tidygeocoder/reference/geocode.html" class="external-link">geocode</a></span><span class="op">(</span><span class="va">.SD</span>,</span>
<span>                            address <span class="op">=</span> <span class="va">Address</span>,</span>
<span>                            method <span class="op">=</span> <span class="st">'arcgis'</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/setDT.html" class="external-link">setDT</a></span><span class="op">(</span><span class="va">ZoneCodesArcgis</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">ZoneCodesArcgis</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Rows: 265</span></span>
<span><span class="co">#&gt; Columns: 7</span></span>
<span><span class="co">#&gt; $ LocationID   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17…</span></span>
<span><span class="co">#&gt; $ Borough      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "EWR", "Queens", "Bronx", "Manhattan", "Staten Island", "…</span></span>
<span><span class="co">#&gt; $ Zone         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Newark Airport", "Jamaica Bay", "Allerton/Pelham Gardens…</span></span>
<span><span class="co">#&gt; $ service_zone <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "EWR", "Boro Zone", "Boro Zone", "Yellow Zone", "Boro Zon…</span></span>
<span><span class="co">#&gt; $ Address      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Newark Airport, EWR, New York, United States", "Jamaica …</span></span>
<span><span class="co">#&gt; $ lat          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 43.06, 40.62, 40.87, 40.73, 40.55, 40.60, 40.77, 40.78, 4…</span></span>
<span><span class="co">#&gt; $ long         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -77.10, -73.82, -73.84, -73.98, -74.17, -74.06, -73.93, -…</span></span></code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Validating the added latitude and longitude, by plotting all the
points in an interactive map from we can highlight the following
issues:</li>
</ol>
<ul>
<li>The location suggested for the Newark Airport is not correct.</li>
<li>More than one zone is represented by one location.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">BoroughColors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">'Manhattan'</span> <span class="op">=</span> <span class="st">'#e41a1c'</span>,</span>
<span>  <span class="st">'Queens'</span> <span class="op">=</span> <span class="st">'#377eb8'</span>,</span>
<span>  <span class="st">'Brooklyn'</span><span class="op">=</span> <span class="st">'#4daf4a'</span>,</span>
<span>  <span class="st">'Bronx'</span> <span class="op">=</span> <span class="st">'#984ea3'</span>,</span>
<span>  <span class="st">'Staten Island'</span> <span class="op">=</span> <span class="st">'#ff7f00'</span>,</span>
<span>  <span class="st">'EWR'</span> <span class="op">=</span> <span class="st">'#a65628'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_map.html">plot_map</a></span><span class="op">(</span></span>
<span>  <span class="va">ZoneCodesArcgis</span>,</span>
<span>  lng_var <span class="op">=</span> <span class="st">"long"</span>,</span>
<span>  lat_var <span class="op">=</span> <span class="st">"lat"</span>,</span>
<span>  color_var <span class="op">=</span> <span class="st">"Borough"</span>,</span>
<span>  color_palette <span class="op">=</span> <span class="va">BoroughColors</span>,</span>
<span>  radius <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  label_var <span class="op">=</span> <span class="st">"Zone"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="leaflet html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addProviderTiles","args":["CartoDB",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[43.06083,40.61703,40.865200017982,40.72599,40.55414,40.60349,40.77205,40.7763,40.75861,40.67302,40.60463,40.70444,40.71131,40.6339,40.77978,40.77731,40.67955071693,40.86999,40.72304,40.85546,40.60186,40.60186,40.60838,40.76187,40.68372,40.63382,40.56478,40.71336,40.57795,40.60315,40.8542,40.85008,40.69535,40.678784667421,40.6629,40.692740347359,40.692740347359,40.69254,40.64364,40.6802,40.799418619169,40.799418619169,40.76748,40.51128,40.71646,40.84702,40.84699,40.714099893777,40.68682,40.714099893777,40.870256909461,40.68978,40.7841,40.684446717712,40.5755,40.74637,40.74637,40.84623,40.83656,40.83359,40.666352822692,40.666352822692,40.67794,40.76863,40.69363,40.70198,40.62133,40.744915240463,40.83318,40.76439,40.65379,40.65379,40.75566,40.815707125937,40.815707125937,40.66643,40.647533853812,40.84539,40.72804,40.708,40.88811,40.74361,40.74361,40.52196,40.649654095456,40.60401,40.70906,40.70906,40.64031,40.74098,40.62114,40.76358,40.74612,40.85946,40.72267,40.70344,40.69319,40.74162,40.55564,40.7544,40.748,40.70141,40.70267,40.70267,40.70267,40.67236,40.73773520932,40.59757,40.55416,40.55649,40.659099,40.7304,40.711474728456,40.711474728456,40.61855,40.82238,40.588138,40.5818,40.83848,40.84173,40.72696,40.7188,40.586449859123,40.65483,40.723440011834,40.81242,40.86596,40.86987,40.7494,40.70179,40.71795,40.64459,40.64626,40.70865,40.73064,40.87239,40.74213,40.77572,40.66692,40.821068764756,40.821068764756,40.773243152153,40.773243152153,40.71891,40.74829,40.745378,40.81748,40.71693,40.683899997121,40.57737,40.808845814501,40.78343,40.87641,40.589547496498,40.61109,40.6355,40.72729,40.73497,40.827432658389,40.71238,40.7588,40.757375,40.80788,40.75422,40.62326,40.81053,40.8291,40.80134,40.84912,40.74855,40.76583,40.57284,40.75306,40.87869,40.74905,40.5639,40.583930001866,40.583930001866,40.77205,40.68012,40.67044,40.83913,40.889288559436,40.86335,40.85443,40.742685475578,40.63365,40.65061,40.67747,40.66047,40.71481,40.74292,40.75647,40.795284230642,40.67502,40.73194,40.70055,40.70074,40.787374765826,40.88547,40.5799,40.76456,40.65954,40.55565,40.69329,40.64207,40.766414,40.83732,40.707149992561,40.59094,40.7252,40.82291,40.82029,40.592248455698,40.68094,40.67544,40.700050978728,40.758916614532,40.758916614532,40.87923,40.62659,40.65014,40.77376,40.734872337033,40.681979438148,40.74244,40.57832998949,40.57832998949,40.758012125134,40.756901597587,40.71337,40.71192,40.74919,40.73687,40.85183,40.77062,40.77062,40.79251,40.79251,40.89507,40.885520014393,40.846205849902,40.85546,40.84231,40.62744,40.75431,40.823763051789,40.83976,40.73497,40.832932863966,40.62102,40.78863,40.786790508562,40.87725,40.71478,40.698337835102,40.65397,40.69263,40.89816,40.74696,40.70969,40.77808,40.77808],[-77.10167,-73.82461000000001,-73.842630050515,-73.98057,-74.17391000000001,-74.0617,-73.92606000000001,-73.92361,-73.78574,-73.78543000000001,-74.00462,-74.01425,-74.0159,-74.0149,-73.77867999999999,-73.78068,-73.954254134186,-73.88573,-73.71545999999999,-73.88569,-73.9939,-73.9939,-74.11615,-73.96637,-73.98179,-73.99693000000001,-73.89296,-73.79886999999999,-73.9601,-73.8214,-73.87146,-73.86682999999999,-73.99405,-73.94408377330601,-73.91728999999999,-73.923882116434,-73.923882116434,-73.73184999999999,-73.90069,-74.00163000000001,-73.95524522581501,-73.95524522581501,-73.97069,-74.25057,-73.99675999999999,-73.78758000000001,-73.89793,-73.98715424302,-73.96469999999999,-73.98715424302,-73.825879003989,-73.99817,-73.84581,-74.002963871067,-73.97845,-73.85483000000001,-73.85483000000001,-73.82071000000001,-73.89775,-73.88836999999999,-73.952248666071,-73.952248666071,-73.89163000000001,-73.74733999999999,-73.98287999999999,-73.98282,-74.00995,-74.00248044924901,-73.91399,-73.87402,-73.93080999999999,-73.93080999999999,-73.81028000000001,-73.934448114471,-73.934448114471,-73.88269,-73.881531762325,-73.89113999999999,-73.98499,-73.93989999999999,-73.82837000000001,-73.88433000000001,-73.88433000000001,-74.19862000000001,-73.952625064858,-73.75248999999999,-74.01061,-74.01061,-73.96183000000001,-73.98967,-73.93528000000001,-73.83004,-73.85279,-73.90212,-73.84791,-73.85041,-73.97168000000001,-73.78299,-74.21396,-73.99185,-73.71324,-73.88720000000001,-74.01424,-74.01424,-74.01424,-73.99027,-73.984524819086,-73.96541999999999,-74.1524,-74.12796,-73.996138,-73.95204,-74.01226522787201,-74.01226522787201,-74.09378,-73.94968,-73.81196300000001,-74.16258000000001,-73.92599,-73.9355,-73.79832,-73.76465,-73.956891156328,-73.84602,-74.006164997819,-73.8845,-73.92610000000001,-73.92094,-73.88755999999999,-73.80853,-73.78269,-73.79436,-73.97108,-73.82890999999999,-73.82408,-73.90154,-73.97781000000001,-73.87452999999999,-73.75215,-73.93568412261899,-73.93568412261899,-73.98183992156299,-73.98183992156299,-73.99609,-73.9575,-73.932194,-73.89816,-73.98423,-73.95761500297,-73.94774,-73.954033071144,-73.96625,-73.911,-73.882072620519,-73.90957,-74.15922,-73.89543999999999,-74.00483,-73.912167289641,-73.8827,-73.97291,-73.96938299999999,-73.94542,-73.99245000000001,-73.95653,-73.96205999999999,-73.90671,-73.90996,-73.90631,-73.97605,-73.80842,-74.09523,-73.86118999999999,-73.87929,-73.75668,-74.11637,-73.966749978236,-73.966749978236,-73.92606000000001,-73.84735999999999,-73.98718,-73.86109,-73.816641931641,-73.80197,-73.86434,-73.989204217904,-74.12873999999999,-73.95386999999999,-73.96583,-73.96278,-73.75076,-73.82061,-73.94729,-73.921313367379,-74.01023000000001,-73.86884000000001,-73.82805999999999,-73.89509,-73.884849080957,-73.90712000000001,-73.83692000000001,-73.94732,-73.73994,-74.21357999999999,-73.75644,-74.09336,-73.896908,-73.83159000000001,-74.00452503655301,-73.94493,-74.00415,-73.86827,-73.84832,-74.071082770758,-73.79089,-73.81113999999999,-73.962456578249,-73.76222747739401,-73.76222747739401,-73.90716,-74.07637,-73.88444,-73.90494,-73.977029887165,-73.93184794067901,-73.92074,-74.011444968177,-74.011444968177,-73.960200066821,-73.990038822312,-74.0038,-73.99692,-73.96795,-73.98996,-73.91625999999999,-73.95703,-73.95703,-73.97320000000001,-73.97320000000001,-73.88015,-73.894680027801,-73.85653302184301,-73.93379,-73.93924,-74.10908999999999,-74.00118999999999,-73.92298825503801,-73.87793000000001,-74.00483,-73.86213999434899,-74.13205000000001,-73.81373000000001,-73.792776615931,-73.8566,-73.95276,-73.962760026992,-73.97785,-73.86102,-73.86736000000001,-73.90279,-74.01167,-73.9485,-73.9485],3,null,null,{"interactive":true,"className":"","stroke":true,"color":["#A65628","#377EB8","#984EA3","#E41A1C","#FF7F00","#FF7F00","#377EB8","#377EB8","#377EB8","#377EB8","#4DAF4A","#E41A1C","#E41A1C","#4DAF4A","#377EB8","#377EB8","#4DAF4A","#984EA3","#377EB8","#984EA3","#4DAF4A","#4DAF4A","#FF7F00","#E41A1C","#4DAF4A","#4DAF4A","#377EB8","#377EB8","#4DAF4A","#377EB8","#984EA3","#984EA3","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#377EB8","#4DAF4A","#4DAF4A","#E41A1C","#E41A1C","#E41A1C","#FF7F00","#E41A1C","#984EA3","#984EA3","#E41A1C","#4DAF4A","#E41A1C","#984EA3","#4DAF4A","#377EB8","#4DAF4A","#4DAF4A","#377EB8","#377EB8","#984EA3","#984EA3","#984EA3","#4DAF4A","#4DAF4A","#4DAF4A","#377EB8","#4DAF4A","#4DAF4A","#4DAF4A","#E41A1C","#984EA3","#377EB8","#4DAF4A","#4DAF4A","#377EB8","#E41A1C","#E41A1C","#4DAF4A","#4DAF4A","#984EA3","#E41A1C","#4DAF4A","#984EA3","#377EB8","#377EB8","#FF7F00","#4DAF4A","#377EB8","#E41A1C","#E41A1C","#4DAF4A","#E41A1C","#4DAF4A","#377EB8","#377EB8","#984EA3","#377EB8","#377EB8","#4DAF4A","#377EB8","#FF7F00","#E41A1C","#377EB8","#377EB8","#E41A1C","#E41A1C","#E41A1C","#4DAF4A","#E41A1C","#4DAF4A","#FF7F00","#FF7F00","#4DAF4A","#4DAF4A","#E41A1C","#E41A1C","#FF7F00","#E41A1C","#377EB8","#FF7F00","#984EA3","#E41A1C","#377EB8","#377EB8","#4DAF4A","#377EB8","#E41A1C","#984EA3","#E41A1C","#E41A1C","#377EB8","#377EB8","#377EB8","#377EB8","#4DAF4A","#377EB8","#377EB8","#984EA3","#E41A1C","#377EB8","#377EB8","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#377EB8","#377EB8","#984EA3","#E41A1C","#4DAF4A","#4DAF4A","#E41A1C","#E41A1C","#E41A1C","#4DAF4A","#4DAF4A","#FF7F00","#377EB8","#E41A1C","#984EA3","#377EB8","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#4DAF4A","#E41A1C","#984EA3","#984EA3","#984EA3","#E41A1C","#377EB8","#FF7F00","#377EB8","#984EA3","#377EB8","#FF7F00","#4DAF4A","#4DAF4A","#377EB8","#377EB8","#4DAF4A","#984EA3","#984EA3","#984EA3","#984EA3","#E41A1C","#FF7F00","#4DAF4A","#4DAF4A","#4DAF4A","#377EB8","#377EB8","#377EB8","#E41A1C","#4DAF4A","#377EB8","#377EB8","#377EB8","#984EA3","#984EA3","#377EB8","#E41A1C","#377EB8","#FF7F00","#377EB8","#FF7F00","#377EB8","#984EA3","#E41A1C","#4DAF4A","#E41A1C","#984EA3","#984EA3","#FF7F00","#377EB8","#377EB8","#4DAF4A","#377EB8","#377EB8","#984EA3","#FF7F00","#4DAF4A","#377EB8","#E41A1C","#4DAF4A","#377EB8","#4DAF4A","#4DAF4A","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#984EA3","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#984EA3","#984EA3","#984EA3","#E41A1C","#E41A1C","#FF7F00","#E41A1C","#984EA3","#984EA3","#E41A1C","#984EA3","#FF7F00","#377EB8","#377EB8","#984EA3","#4DAF4A","#4DAF4A","#4DAF4A","#377EB8","#984EA3","#377EB8","#E41A1C","#E41A1C","#E41A1C"],"weight":5,"opacity":0.5,"fill":true,"fillColor":["#A65628","#377EB8","#984EA3","#E41A1C","#FF7F00","#FF7F00","#377EB8","#377EB8","#377EB8","#377EB8","#4DAF4A","#E41A1C","#E41A1C","#4DAF4A","#377EB8","#377EB8","#4DAF4A","#984EA3","#377EB8","#984EA3","#4DAF4A","#4DAF4A","#FF7F00","#E41A1C","#4DAF4A","#4DAF4A","#377EB8","#377EB8","#4DAF4A","#377EB8","#984EA3","#984EA3","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#377EB8","#4DAF4A","#4DAF4A","#E41A1C","#E41A1C","#E41A1C","#FF7F00","#E41A1C","#984EA3","#984EA3","#E41A1C","#4DAF4A","#E41A1C","#984EA3","#4DAF4A","#377EB8","#4DAF4A","#4DAF4A","#377EB8","#377EB8","#984EA3","#984EA3","#984EA3","#4DAF4A","#4DAF4A","#4DAF4A","#377EB8","#4DAF4A","#4DAF4A","#4DAF4A","#E41A1C","#984EA3","#377EB8","#4DAF4A","#4DAF4A","#377EB8","#E41A1C","#E41A1C","#4DAF4A","#4DAF4A","#984EA3","#E41A1C","#4DAF4A","#984EA3","#377EB8","#377EB8","#FF7F00","#4DAF4A","#377EB8","#E41A1C","#E41A1C","#4DAF4A","#E41A1C","#4DAF4A","#377EB8","#377EB8","#984EA3","#377EB8","#377EB8","#4DAF4A","#377EB8","#FF7F00","#E41A1C","#377EB8","#377EB8","#E41A1C","#E41A1C","#E41A1C","#4DAF4A","#E41A1C","#4DAF4A","#FF7F00","#FF7F00","#4DAF4A","#4DAF4A","#E41A1C","#E41A1C","#FF7F00","#E41A1C","#377EB8","#FF7F00","#984EA3","#E41A1C","#377EB8","#377EB8","#4DAF4A","#377EB8","#E41A1C","#984EA3","#E41A1C","#E41A1C","#377EB8","#377EB8","#377EB8","#377EB8","#4DAF4A","#377EB8","#377EB8","#984EA3","#E41A1C","#377EB8","#377EB8","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#377EB8","#377EB8","#984EA3","#E41A1C","#4DAF4A","#4DAF4A","#E41A1C","#E41A1C","#E41A1C","#4DAF4A","#4DAF4A","#FF7F00","#377EB8","#E41A1C","#984EA3","#377EB8","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#4DAF4A","#E41A1C","#984EA3","#984EA3","#984EA3","#E41A1C","#377EB8","#FF7F00","#377EB8","#984EA3","#377EB8","#FF7F00","#4DAF4A","#4DAF4A","#377EB8","#377EB8","#4DAF4A","#984EA3","#984EA3","#984EA3","#984EA3","#E41A1C","#FF7F00","#4DAF4A","#4DAF4A","#4DAF4A","#377EB8","#377EB8","#377EB8","#E41A1C","#4DAF4A","#377EB8","#377EB8","#377EB8","#984EA3","#984EA3","#377EB8","#E41A1C","#377EB8","#FF7F00","#377EB8","#FF7F00","#377EB8","#984EA3","#E41A1C","#4DAF4A","#E41A1C","#984EA3","#984EA3","#FF7F00","#377EB8","#377EB8","#4DAF4A","#377EB8","#377EB8","#984EA3","#FF7F00","#4DAF4A","#377EB8","#E41A1C","#4DAF4A","#377EB8","#4DAF4A","#4DAF4A","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#984EA3","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#984EA3","#984EA3","#984EA3","#E41A1C","#E41A1C","#FF7F00","#E41A1C","#984EA3","#984EA3","#E41A1C","#984EA3","#FF7F00","#377EB8","#377EB8","#984EA3","#4DAF4A","#4DAF4A","#4DAF4A","#377EB8","#984EA3","#377EB8","#E41A1C","#E41A1C","#E41A1C"],"fillOpacity":0.2},null,null,null,null,["Newark Airport","Jamaica Bay","Allerton/Pelham Gardens","Alphabet City","Arden Heights","Arrochar/Fort Wadsworth","Astoria","Astoria Park","Auburndale","Baisley Park","Bath Beach","Battery Park","Battery Park City","Bay Ridge","Bay Terrace/Fort Totten","Bayside","Bedford","Bedford Park","Bellerose","Belmont","Bensonhurst East","Bensonhurst West","Bloomfield/Emerson Hill","Bloomingdale","Boerum Hill","Borough Park","Breezy Point/Fort Tilden/Riis Beach","Briarwood/Jamaica Hills","Brighton Beach","Broad Channel","Bronx Park","Bronxdale","Brooklyn Heights","Brooklyn Navy Yard","Brownsville","Bushwick North","Bushwick South","Cambria Heights","Canarsie","Carroll Gardens","Central Harlem","Central Harlem North","Central Park","Charleston/Tottenville","Chinatown","City Island","Claremont/Bathgate","Clinton East","Clinton Hill","Clinton West","Co-Op City","Cobble Hill","College Point","Columbia Street","Coney Island","Corona","Corona","Country Club","Crotona Park","Crotona Park East","Crown Heights North","Crown Heights South","Cypress Hills","Douglaston","Downtown Brooklyn/MetroTech","DUMBO/Vinegar Hill","Dyker Heights","East Chelsea","East Concourse/Concourse Village","East Elmhurst","East Flatbush/Farragut","East Flatbush/Remsen Village","East Flushing","East Harlem North","East Harlem South","East New York","East New York/Pennsylvania Avenue","East Tremont","East Village","East Williamsburg","Eastchester","Elmhurst","Elmhurst/Maspeth","Eltingville/Annadale/Prince's Bay","Erasmus","Far Rockaway","Financial District North","Financial District South","Flatbush/Ditmas Park","Flatiron","Flatlands","Flushing","Flushing Meadows-Corona Park","Fordham South","Forest Hills","Forest Park/Highland Park","Fort Greene","Fresh Meadows","Freshkills Park","Garment District","Glen Oaks","Glendale","Governor's Island/Ellis Island/Liberty Island","Governor's Island/Ellis Island/Liberty Island","Governor's Island/Ellis Island/Liberty Island","Gowanus","Gramercy","Gravesend","Great Kills","Great Kills Park","Green-Wood Cemetery","Greenpoint","Greenwich Village North","Greenwich Village South","Grymes Hill/Clifton","Hamilton Heights","Hammels/Arverne","Heartland Village/Todt Hill","Highbridge","Highbridge Park","Hillcrest/Pomonok","Hollis","Homecrest","Howard Beach","Hudson Sq","Hunts Point","Inwood","Inwood Hill Park","Jackson Heights","Jamaica","Jamaica Estates","JFK Airport","Kensington","Kew Gardens","Kew Gardens Hills","Kingsbridge Heights","Kips Bay","LaGuardia Airport","Laurelton","Lenox Hill East","Lenox Hill West","Lincoln Square East","Lincoln Square West","Little Italy/NoLiTa","Long Island City/Hunters Point","Long Island City/Queens Plaza","Longwood","Lower East Side","Madison","Manhattan Beach","Manhattan Valley","Manhattanville","Marble Hill","Marine Park/Floyd Bennett Field","Marine Park/Mill Basin","Mariners Harbor","Maspeth","Meatpacking/West Village West","Melrose South","Middle Village","Midtown Center","Midtown East","Midtown North","Midtown South","Midwood","Morningside Heights","Morrisania/Melrose","Mott Haven/Port Morris","Mount Hope","Murray Hill","Murray Hill-Queens","New Dorp/Midland Beach","North Corona","Norwood","Oakland Gardens","Oakwood","Ocean Hill","Ocean Parkway South","Old Astoria","Ozone Park","Park Slope","Parkchester","Pelham Bay","Pelham Bay Park","Pelham Parkway","Penn Station/Madison Sq West","Port Richmond","Prospect-Lefferts Gardens","Prospect Heights","Prospect Park","Queens Village","Queensboro Hill","Queensbridge/Ravenswood","Randalls Island","Red Hook","Rego Park","Richmond Hill","Ridgewood","Rikers Island","Riverdale/North Riverdale/Fieldston","Rockaway Park","Roosevelt Island","Rosedale","Rossville/Woodrow","Saint Albans","Saint George/New Brighton","Saint Michaels Cemetery/Woodside","Schuylerville/Edgewater Park","Seaport","Sheepshead Bay","SoHo","Soundview/Bruckner","Soundview/Castle Hill","South Beach/Dongan Hills","South Jamaica","South Ozone Park","South Williamsburg","Springfield Gardens North","Springfield Gardens South","Spuyten Duyvil/Kingsbridge","Stapleton","Starrett City","Steinway","Stuy Town/Peter Cooper Village","Stuyvesant Heights","Sunnyside","Sunset Park East","Sunset Park West","Sutton Place/Turtle Bay North","Times Sq/Theatre District","TriBeCa/Civic Center","Two Bridges/Seward Park","UN/Turtle Bay South","Union Sq","University Heights/Morris Heights","Upper East Side North","Upper East Side South","Upper West Side North","Upper West Side South","Van Cortlandt Park","Van Cortlandt Village","Van Nest/Morris Park","Washington Heights North","Washington Heights South","West Brighton","West Chelsea/Hudson Yards","West Concourse","West Farms/Bronx River","West Village","Westchester Village/Unionport","Westerleigh","Whitestone","Willets Point","Williamsbridge/Olinville","Williamsburg (North Side)","Williamsburg (South Side)","Windsor Terrace","Woodhaven","Woodlawn/Wakefield","Woodside","World Trade Center","Yorkville East","Yorkville West"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["#984EA3","#4DAF4A","#A65628","#E41A1C","#377EB8","#FF7F00"],"labels":["Bronx","Brooklyn","EWR","Manhattan","Queens","Staten Island"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"topleft","type":"factor","title":null,"extra":null,"layerId":null,"className":"info legend","group":null}]}],"limits":{"lat":[40.51128,43.06083],"lng":[-77.10167,-73.71324]}},"evals":[],"jsHooks":[]}</script><p>Now we can see the new map after solving the prior problems.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ZoneCodesArcgisClean</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clean_zone_manually.html">clean_zone_manually</a></span><span class="op">(</span><span class="va">ZoneCodesArcgis</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_map.html">plot_map</a></span><span class="op">(</span></span>
<span>  <span class="va">ZoneCodesArcgisClean</span>,</span>
<span>  lng_var <span class="op">=</span> <span class="st">"long"</span>,</span>
<span>  lat_var <span class="op">=</span> <span class="st">"lat"</span>,</span>
<span>  color_var <span class="op">=</span> <span class="st">"Borough"</span>,</span>
<span>  color_palette <span class="op">=</span> <span class="va">BoroughColors</span>,</span>
<span>  radius <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  label_var <span class="op">=</span> <span class="st">"Zone"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="leaflet html-widget html-fill-item" id="htmlwidget-e5c8c404fe174e4c81bd" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addProviderTiles","args":["CartoDB",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[40.689499,40.61703,40.865200017982,40.72599,40.55414,40.60349,40.77205,40.7763,40.75861,40.67302,40.60463,40.70444,40.71131,40.6339,40.77978,40.77731,40.67955071693,40.86999,40.72304,40.85546,40.60186,40.60186,40.60838,40.76187,40.68372,40.63382,40.56478,40.71336,40.57795,40.60315,40.8542,40.85008,40.69535,40.678784667421,40.6629,40.692740347359,40.692740347359,40.69254,40.64364,40.6802,40.799418619169,40.799418619169,40.76748,40.51128,40.71646,40.84702,40.84699,40.714099893777,40.68682,40.714099893777,40.870256909461,40.68978,40.7841,40.684446717712,40.5755,40.74637,40.74637,40.84623,40.83656,40.83359,40.666352822692,40.666352822692,40.67794,40.76863,40.69363,40.70198,40.62133,40.744915240463,40.83318,40.76439,40.65379,40.65379,40.75566,40.815707125937,40.815707125937,40.66643,40.647533853812,40.84539,40.72804,40.708,40.88811,40.74361,40.74361,40.52196,40.649654095456,40.60401,40.70906,40.70906,40.64031,40.74098,40.62114,40.76358,40.74612,40.85946,40.72267,40.70344,40.69319,40.74162,40.55564,40.7544,40.748,40.70141,40.70267,40.70267,40.70267,40.67236,40.73773520932,40.59757,40.55416,40.55649,40.659099,40.7304,40.711474728456,40.711474728456,40.61855,40.82238,40.588138,40.5818,40.83848,40.84173,40.72696,40.7188,40.586449859123,40.65483,40.723440011834,40.81242,40.86596,40.86987,40.7494,40.70179,40.71795,40.64459,40.64626,40.70865,40.73064,40.87239,40.74213,40.77572,40.66692,40.821068764756,40.821068764756,40.773243152153,40.773243152153,40.71891,40.74829,40.745378,40.81748,40.71693,40.683899997121,40.57737,40.808845814501,40.78343,40.87641,40.589547496498,40.61109,40.6355,40.72729,40.73497,40.827432658389,40.71238,40.7588,40.757375,40.80788,40.75422,40.62326,40.81053,40.8291,40.80134,40.84912,40.74855,40.76583,40.57284,40.75306,40.87869,40.74905,40.5639,40.583930001866,40.583930001866,40.77205,40.68012,40.67044,40.83913,40.889288559436,40.86335,40.85443,40.742685475578,40.63365,40.65061,40.67747,40.66047,40.71481,40.74292,40.75647,40.795284230642,40.67502,40.73194,40.70055,40.70074,40.787374765826,40.88547,40.5799,40.76456,40.65954,40.55565,40.69329,40.64207,40.766414,40.83732,40.707149992561,40.59094,40.7252,40.82291,40.82029,40.592248455698,40.68094,40.67544,40.700050978728,40.758916614532,40.758916614532,40.87923,40.62659,40.65014,40.77376,40.734872337033,40.681979438148,40.74244,40.57832998949,40.57832998949,40.758012125134,40.756901597587,40.71337,40.71192,40.74919,40.73687,40.85183,40.77062,40.77062,40.79251,40.79251,40.89507,40.885520014393,40.846205849902,40.85546,40.84231,40.62744,40.75431,40.823763051789,40.83976,40.73497,40.832932863966,40.62102,40.78863,40.786790508562,40.87725,40.71478,40.698337835102,40.65397,40.69263,40.89816,40.74696,40.70969,40.77808,40.77808],[-74.17448400000001,-73.82461000000001,-73.842630050515,-73.98057,-74.17391000000001,-74.0617,-73.92606000000001,-73.92361,-73.78574,-73.78543000000001,-74.00462,-74.01425,-74.0159,-74.0149,-73.77867999999999,-73.78068,-73.954254134186,-73.88573,-73.71545999999999,-73.88569,-73.9939,-73.9939,-74.11615,-73.96637,-73.98179,-73.99693000000001,-73.89296,-73.79886999999999,-73.9601,-73.8214,-73.87146,-73.86682999999999,-73.99405,-73.94408377330601,-73.91728999999999,-73.923882116434,-73.923882116434,-73.73184999999999,-73.90069,-74.00163000000001,-73.95524522581501,-73.95524522581501,-73.97069,-74.25057,-73.99675999999999,-73.78758000000001,-73.89793,-73.98715424302,-73.96469999999999,-73.98715424302,-73.825879003989,-73.99817,-73.84581,-74.002963871067,-73.97845,-73.85483000000001,-73.85483000000001,-73.82071000000001,-73.89775,-73.88836999999999,-73.952248666071,-73.952248666071,-73.89163000000001,-73.74733999999999,-73.98287999999999,-73.98282,-74.00995,-74.00248044924901,-73.91399,-73.87402,-73.93080999999999,-73.93080999999999,-73.81028000000001,-73.934448114471,-73.934448114471,-73.88269,-73.881531762325,-73.89113999999999,-73.98499,-73.93989999999999,-73.82837000000001,-73.88433000000001,-73.88433000000001,-74.19862000000001,-73.952625064858,-73.75248999999999,-74.01061,-74.01061,-73.96183000000001,-73.98967,-73.93528000000001,-73.83004,-73.85279,-73.90212,-73.84791,-73.85041,-73.97168000000001,-73.78299,-74.21396,-73.99185,-73.71324,-73.88720000000001,-74.01424,-74.01424,-74.01424,-73.99027,-73.984524819086,-73.96541999999999,-74.1524,-74.12796,-73.996138,-73.95204,-74.01226522787201,-74.01226522787201,-74.09378,-73.94968,-73.81196300000001,-74.16258000000001,-73.92599,-73.9355,-73.79832,-73.76465,-73.956891156328,-73.84602,-74.006164997819,-73.8845,-73.92610000000001,-73.92094,-73.88755999999999,-73.80853,-73.78269,-73.79436,-73.97108,-73.82890999999999,-73.82408,-73.90154,-73.97781000000001,-73.87452999999999,-73.75215,-73.93568412261899,-73.93568412261899,-73.98183992156299,-73.98183992156299,-73.99609,-73.9575,-73.932194,-73.89816,-73.98423,-73.95761500297,-73.94774,-73.954033071144,-73.96625,-73.911,-73.882072620519,-73.90957,-74.15922,-73.89543999999999,-74.00483,-73.912167289641,-73.8827,-73.97291,-73.96938299999999,-73.94542,-73.99245000000001,-73.95653,-73.96205999999999,-73.90671,-73.90996,-73.90631,-73.97605,-73.80842,-74.09523,-73.86118999999999,-73.87929,-73.75668,-74.11637,-73.966749978236,-73.966749978236,-73.92606000000001,-73.84735999999999,-73.98718,-73.86109,-73.816641931641,-73.80197,-73.86434,-73.989204217904,-74.12873999999999,-73.95386999999999,-73.96583,-73.96278,-73.75076,-73.82061,-73.94729,-73.921313367379,-74.01023000000001,-73.86884000000001,-73.82805999999999,-73.89509,-73.884849080957,-73.90712000000001,-73.83692000000001,-73.94732,-73.73994,-74.21357999999999,-73.75644,-74.09336,-73.896908,-73.83159000000001,-74.00452503655301,-73.94493,-74.00415,-73.86827,-73.84832,-74.071082770758,-73.79089,-73.81113999999999,-73.962456578249,-73.76222747739401,-73.76222747739401,-73.90716,-74.07637,-73.88444,-73.90494,-73.977029887165,-73.93184794067901,-73.92074,-74.011444968177,-74.011444968177,-73.960200066821,-73.990038822312,-74.0038,-73.99692,-73.96795,-73.98996,-73.91625999999999,-73.95703,-73.95703,-73.97320000000001,-73.97320000000001,-73.88015,-73.894680027801,-73.85653302184301,-73.93379,-73.93924,-74.10908999999999,-74.00118999999999,-73.92298825503801,-73.87793000000001,-74.00483,-73.86213999434899,-74.13205000000001,-73.81373000000001,-73.792776615931,-73.8566,-73.95276,-73.962760026992,-73.97785,-73.86102,-73.86736000000001,-73.90279,-74.01167,-73.9485,-73.9485],3,null,null,{"interactive":true,"className":"","stroke":true,"color":["#A65628","#377EB8","#984EA3","#E41A1C","#FF7F00","#FF7F00","#377EB8","#377EB8","#377EB8","#377EB8","#4DAF4A","#E41A1C","#E41A1C","#4DAF4A","#377EB8","#377EB8","#4DAF4A","#984EA3","#377EB8","#984EA3","#4DAF4A","#4DAF4A","#FF7F00","#E41A1C","#4DAF4A","#4DAF4A","#377EB8","#377EB8","#4DAF4A","#377EB8","#984EA3","#984EA3","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#377EB8","#4DAF4A","#4DAF4A","#E41A1C","#E41A1C","#E41A1C","#FF7F00","#E41A1C","#984EA3","#984EA3","#E41A1C","#4DAF4A","#E41A1C","#984EA3","#4DAF4A","#377EB8","#4DAF4A","#4DAF4A","#377EB8","#377EB8","#984EA3","#984EA3","#984EA3","#4DAF4A","#4DAF4A","#4DAF4A","#377EB8","#4DAF4A","#4DAF4A","#4DAF4A","#E41A1C","#984EA3","#377EB8","#4DAF4A","#4DAF4A","#377EB8","#E41A1C","#E41A1C","#4DAF4A","#4DAF4A","#984EA3","#E41A1C","#4DAF4A","#984EA3","#377EB8","#377EB8","#FF7F00","#4DAF4A","#377EB8","#E41A1C","#E41A1C","#4DAF4A","#E41A1C","#4DAF4A","#377EB8","#377EB8","#984EA3","#377EB8","#377EB8","#4DAF4A","#377EB8","#FF7F00","#E41A1C","#377EB8","#377EB8","#E41A1C","#E41A1C","#E41A1C","#4DAF4A","#E41A1C","#4DAF4A","#FF7F00","#FF7F00","#4DAF4A","#4DAF4A","#E41A1C","#E41A1C","#FF7F00","#E41A1C","#377EB8","#FF7F00","#984EA3","#E41A1C","#377EB8","#377EB8","#4DAF4A","#377EB8","#E41A1C","#984EA3","#E41A1C","#E41A1C","#377EB8","#377EB8","#377EB8","#377EB8","#4DAF4A","#377EB8","#377EB8","#984EA3","#E41A1C","#377EB8","#377EB8","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#377EB8","#377EB8","#984EA3","#E41A1C","#4DAF4A","#4DAF4A","#E41A1C","#E41A1C","#E41A1C","#4DAF4A","#4DAF4A","#FF7F00","#377EB8","#E41A1C","#984EA3","#377EB8","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#4DAF4A","#E41A1C","#984EA3","#984EA3","#984EA3","#E41A1C","#377EB8","#FF7F00","#377EB8","#984EA3","#377EB8","#FF7F00","#4DAF4A","#4DAF4A","#377EB8","#377EB8","#4DAF4A","#984EA3","#984EA3","#984EA3","#984EA3","#E41A1C","#FF7F00","#4DAF4A","#4DAF4A","#4DAF4A","#377EB8","#377EB8","#377EB8","#E41A1C","#4DAF4A","#377EB8","#377EB8","#377EB8","#984EA3","#984EA3","#377EB8","#E41A1C","#377EB8","#FF7F00","#377EB8","#FF7F00","#377EB8","#984EA3","#E41A1C","#4DAF4A","#E41A1C","#984EA3","#984EA3","#FF7F00","#377EB8","#377EB8","#4DAF4A","#377EB8","#377EB8","#984EA3","#FF7F00","#4DAF4A","#377EB8","#E41A1C","#4DAF4A","#377EB8","#4DAF4A","#4DAF4A","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#984EA3","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#984EA3","#984EA3","#984EA3","#E41A1C","#E41A1C","#FF7F00","#E41A1C","#984EA3","#984EA3","#E41A1C","#984EA3","#FF7F00","#377EB8","#377EB8","#984EA3","#4DAF4A","#4DAF4A","#4DAF4A","#377EB8","#984EA3","#377EB8","#E41A1C","#E41A1C","#E41A1C"],"weight":5,"opacity":0.5,"fill":true,"fillColor":["#A65628","#377EB8","#984EA3","#E41A1C","#FF7F00","#FF7F00","#377EB8","#377EB8","#377EB8","#377EB8","#4DAF4A","#E41A1C","#E41A1C","#4DAF4A","#377EB8","#377EB8","#4DAF4A","#984EA3","#377EB8","#984EA3","#4DAF4A","#4DAF4A","#FF7F00","#E41A1C","#4DAF4A","#4DAF4A","#377EB8","#377EB8","#4DAF4A","#377EB8","#984EA3","#984EA3","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#377EB8","#4DAF4A","#4DAF4A","#E41A1C","#E41A1C","#E41A1C","#FF7F00","#E41A1C","#984EA3","#984EA3","#E41A1C","#4DAF4A","#E41A1C","#984EA3","#4DAF4A","#377EB8","#4DAF4A","#4DAF4A","#377EB8","#377EB8","#984EA3","#984EA3","#984EA3","#4DAF4A","#4DAF4A","#4DAF4A","#377EB8","#4DAF4A","#4DAF4A","#4DAF4A","#E41A1C","#984EA3","#377EB8","#4DAF4A","#4DAF4A","#377EB8","#E41A1C","#E41A1C","#4DAF4A","#4DAF4A","#984EA3","#E41A1C","#4DAF4A","#984EA3","#377EB8","#377EB8","#FF7F00","#4DAF4A","#377EB8","#E41A1C","#E41A1C","#4DAF4A","#E41A1C","#4DAF4A","#377EB8","#377EB8","#984EA3","#377EB8","#377EB8","#4DAF4A","#377EB8","#FF7F00","#E41A1C","#377EB8","#377EB8","#E41A1C","#E41A1C","#E41A1C","#4DAF4A","#E41A1C","#4DAF4A","#FF7F00","#FF7F00","#4DAF4A","#4DAF4A","#E41A1C","#E41A1C","#FF7F00","#E41A1C","#377EB8","#FF7F00","#984EA3","#E41A1C","#377EB8","#377EB8","#4DAF4A","#377EB8","#E41A1C","#984EA3","#E41A1C","#E41A1C","#377EB8","#377EB8","#377EB8","#377EB8","#4DAF4A","#377EB8","#377EB8","#984EA3","#E41A1C","#377EB8","#377EB8","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#377EB8","#377EB8","#984EA3","#E41A1C","#4DAF4A","#4DAF4A","#E41A1C","#E41A1C","#E41A1C","#4DAF4A","#4DAF4A","#FF7F00","#377EB8","#E41A1C","#984EA3","#377EB8","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#4DAF4A","#E41A1C","#984EA3","#984EA3","#984EA3","#E41A1C","#377EB8","#FF7F00","#377EB8","#984EA3","#377EB8","#FF7F00","#4DAF4A","#4DAF4A","#377EB8","#377EB8","#4DAF4A","#984EA3","#984EA3","#984EA3","#984EA3","#E41A1C","#FF7F00","#4DAF4A","#4DAF4A","#4DAF4A","#377EB8","#377EB8","#377EB8","#E41A1C","#4DAF4A","#377EB8","#377EB8","#377EB8","#984EA3","#984EA3","#377EB8","#E41A1C","#377EB8","#FF7F00","#377EB8","#FF7F00","#377EB8","#984EA3","#E41A1C","#4DAF4A","#E41A1C","#984EA3","#984EA3","#FF7F00","#377EB8","#377EB8","#4DAF4A","#377EB8","#377EB8","#984EA3","#FF7F00","#4DAF4A","#377EB8","#E41A1C","#4DAF4A","#377EB8","#4DAF4A","#4DAF4A","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#984EA3","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#984EA3","#984EA3","#984EA3","#E41A1C","#E41A1C","#FF7F00","#E41A1C","#984EA3","#984EA3","#E41A1C","#984EA3","#FF7F00","#377EB8","#377EB8","#984EA3","#4DAF4A","#4DAF4A","#4DAF4A","#377EB8","#984EA3","#377EB8","#E41A1C","#E41A1C","#E41A1C"],"fillOpacity":0.2},null,null,null,null,["Newark Airport","Jamaica Bay","Allerton/Pelham Gardens","Alphabet City","Arden Heights","Arrochar/Fort Wadsworth","(Old) Astoria","Astoria Park","Auburndale","Baisley Park","Bath Beach","Battery Park","Battery Park City","Bay Ridge","Bay Terrace/Fort Totten","Bayside","Bedford","Bedford Park","Bellerose","Belmont","Bensonhurst (East|West)","Bensonhurst (East|West)","Bloomfield/Emerson Hill","Bloomingdale","Boerum Hill","Borough Park","Breezy Point/Fort Tilden/Riis Beach","Briarwood/Jamaica Hills","Brighton Beach","Broad Channel","Bronx Park","Bronxdale","Brooklyn Heights","Brooklyn Navy Yard","Brownsville","Bushwick (North|South)","Bushwick (North|South)","Cambria Heights","Canarsie","Carroll Gardens","Central Harlem (North)","Central Harlem (North)","Central Park","Charleston/Tottenville","Chinatown","City Island","Claremont/Bathgate","Clinton (East|West)","Clinton Hill","Clinton (East|West)","Co-Op City","Cobble Hill","College Point","Columbia Street","Coney Island","Corona","Corona","Country Club","Crotona Park","Crotona Park East","Crown Heights (North|South)","Crown Heights (North|South)","Cypress Hills","Douglaston","Downtown Brooklyn/MetroTech","DUMBO/Vinegar Hill","Dyker Heights","East Chelsea","East Concourse/Concourse Village","East Elmhurst","East Flatbush (Farragut|Remsen Village)","East Flatbush (Farragut|Remsen Village)","East Flushing","East Harlem (North|South)","East Harlem (North|South)","East New York","East New York/Pennsylvania Avenue","East Tremont","East Village","East Williamsburg","Eastchester","Elmhurst (Maspeth)","Elmhurst (Maspeth)","Eltingville/Annadale/Prince's Bay","Erasmus","Far Rockaway","Financial District (North|South)","Financial District (North|South)","Flatbush/Ditmas Park","Flatiron","Flatlands","Flushing","Flushing Meadows-Corona Park","Fordham South","Forest Hills","Forest Park/Highland Park","Fort Greene","Fresh Meadows","Freshkills Park","Garment District","Glen Oaks","Glendale","Governor's Island/Ellis Island/Liberty Island","Governor's Island/Ellis Island/Liberty Island","Governor's Island/Ellis Island/Liberty Island","Gowanus","Gramercy","Gravesend","Great Kills","Great Kills Park","Green-Wood Cemetery","Greenpoint","Greenwich Village (North|South)","Greenwich Village (North|South)","Grymes Hill/Clifton","Hamilton Heights","Hammels/Arverne","Heartland Village/Todt Hill","Highbridge","Highbridge Park","Hillcrest/Pomonok","Hollis","Homecrest","Howard Beach","Hudson Sq","Hunts Point","Inwood","Inwood Hill Park","Jackson Heights","Jamaica","Jamaica Estates","JFK Airport","Kensington","Kew Gardens","Kew Gardens Hills","Kingsbridge Heights","Kips Bay","LaGuardia Airport","Laurelton","Lenox Hill (East|West)","Lenox Hill (East|West)","Lincoln Square (East|West)","Lincoln Square (East|West)","Little Italy/NoLiTa","Long Island City/Hunters Point","Long Island City/Queens Plaza","Longwood","Lower East Side","Madison","Manhattan Beach","Manhattan Valley","Manhattanville","Marble Hill","Marine Park/Floyd Bennett Field","Marine Park/Mill Basin","Mariners Harbor","Maspeth","(Meatpacking) West Village","Melrose South","Middle Village","Midtown Center","Midtown East","Midtown North","Midtown South","Midwood","Morningside Heights","Morrisania/Melrose","Mott Haven/Port Morris","Mount Hope","Murray Hill","Murray Hill-Queens","New Dorp/Midland Beach","North Corona","Norwood","Oakland Gardens","Oakwood","Ocean (Hill|Parkway South)","Ocean (Hill|Parkway South)","(Old) Astoria","Ozone Park","Park Slope","Parkchester","Pelham Bay","Pelham Bay Park","Pelham Parkway","Penn Station/Madison Sq West","Port Richmond","Prospect-Lefferts Gardens","Prospect Heights","Prospect Park","Queens Village","Queensboro Hill","Queensbridge/Ravenswood","Randalls Island","Red Hook","Rego Park","Richmond Hill","Ridgewood","Rikers Island","Riverdale/North Riverdale/Fieldston","Rockaway Park","Roosevelt Island","Rosedale","Rossville/Woodrow","Saint Albans","Saint George/New Brighton","Saint Michaels Cemetery/Woodside","Schuylerville/Edgewater Park","Seaport","Sheepshead Bay","SoHo","Soundview/Bruckner","Soundview/Castle Hill","South Beach/Dongan Hills","South Jamaica","South Ozone Park","South Williamsburg","Springfield Gardens (North|South)","Springfield Gardens (North|South)","Spuyten Duyvil/Kingsbridge","Stapleton","Starrett City","Steinway","Stuy Town/Peter Cooper Village","Stuyvesant Heights","Sunnyside","Sunset Park (East|West)","Sunset Park (East|West)","Sutton Place/Turtle Bay North","Times Sq/Theatre District","TriBeCa/Civic Center","Two Bridges/Seward Park","UN/Turtle Bay South","Union Sq","University Heights/Morris Heights","Upper East Side (North|South)","Upper East Side (North|South)","Upper West Side (North|South)","Upper West Side (North|South)","Van Cortlandt Park","Van Cortlandt Village","Van Nest/Morris Park","Washington Heights North","Washington Heights South","West Brighton","West Chelsea/Hudson Yards","West Concourse","West Farms/Bronx River","(Meatpacking) West Village","Westchester Village/Unionport","Westerleigh","Whitestone","Willets Point","Williamsbridge/Olinville","Williamsburg (North Side)","Williamsburg (South Side)","Windsor Terrace","Woodhaven","Woodlawn/Wakefield","Woodside","World Trade Center","Yorkville (East|West)","Yorkville (East|West)"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["#984EA3","#4DAF4A","#A65628","#E41A1C","#377EB8","#FF7F00"],"labels":["Bronx","Brooklyn","EWR","Manhattan","Queens","Staten Island"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"topleft","type":"factor","title":null,"extra":null,"layerId":null,"className":"info legend","group":null}]}],"limits":{"lat":[40.51128,40.89816],"lng":[-74.25057,-73.71324]}},"evals":[],"jsHooks":[]}</script><ol start="5" style="list-style-type: decimal">
<li>Counting the number of trips for each code, collecting and
translating the zone codes.</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TripsZoneDistribution</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">NycTrips2022</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/count_pct.html">count_pct</a></span><span class="op">(</span><span class="va">PULocationID</span>, <span class="va">DOLocationID</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_zone_description.html">add_zone_description</a></span><span class="op">(</span>zone_dt <span class="op">=</span> <span class="va">ZoneCodesArcgisClean</span>,</span>
<span>                       start_id_col <span class="op">=</span> <span class="st">"PULocationID"</span>,</span>
<span>                       end_id_col <span class="op">=</span> <span class="st">"DOLocationID"</span>,</span>
<span>                       zone_id_col <span class="op">=</span> <span class="st">"LocationID"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">TripsZoneDistribution</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 65,445</span></span>
<span><span class="co">#&gt; Columns: 15</span></span>
<span><span class="co">#&gt; $ start_borough      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Queens", "Brooklyn", "Queens", "Brooklyn", "Brookl…</span></span>
<span><span class="co">#&gt; $ start_zone         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "JFK Airport", "East New York", "LaGuardia Airport"…</span></span>
<span><span class="co">#&gt; $ start_service_zone <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Airports", "Boro Zone", "Airports", "Boro Zone", "…</span></span>
<span><span class="co">#&gt; $ start_address      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "JFK Airport, Queens, New York, United States", "Ea…</span></span>
<span><span class="co">#&gt; $ start_lat          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 40.64, 40.67, 40.78, 40.63, 40.64, 40.67, 40.63, 40…</span></span>
<span><span class="co">#&gt; $ start_long         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -73.79, -73.88, -73.87, -74.00, -73.90, -73.95, -74…</span></span>
<span><span class="co">#&gt; $ end_borough        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Unknown", "Brooklyn", "Unknown", "Brooklyn", "Broo…</span></span>
<span><span class="co">#&gt; $ end_zone           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "NA", "East New York", "NA", "Borough Park", "Canar…</span></span>
<span><span class="co">#&gt; $ end_service_zone   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "N/A", "Boro Zone", "N/A", "Boro Zone", "Boro Zone"…</span></span>
<span><span class="co">#&gt; $ end_address        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "NA, Unknown, New York, United States", "East New Y…</span></span>
<span><span class="co">#&gt; $ end_lat            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 40.71, 40.67, 40.71, 40.63, 40.64, 40.67, 40.63, 40…</span></span>
<span><span class="co">#&gt; $ end_long           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -74.01, -73.88, -74.01, -74.00, -73.90, -73.95, -74…</span></span>
<span><span class="co">#&gt; $ n                  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 690618, 640891, 453413, 383687, 368971, 324967, 272…</span></span>
<span><span class="co">#&gt; $ pct                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.003, 0.003, 0.002, 0.002, 0.002, 0.002, 0.001, 0.…</span></span>
<span><span class="co">#&gt; $ pct_cumulative     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.003, 0.006, 0.008, 0.010, 0.012, 0.014, 0.015, 0.…</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="individual-distributions">Individual distributions<a class="anchor" aria-label="anchor" href="#individual-distributions"></a>
</h2>
<div class="section level3">
<h3 id="categorical-variables">Categorical variables<a class="anchor" aria-label="anchor" href="#categorical-variables"></a>
</h3>
<p>Let’s starting counting and checking the proportions related to each
category.</p>
<div class="section level4">
<h4 id="company">company<a class="anchor" aria-label="anchor" href="#company"></a>
</h4>
<p>The majority number of trips are done by <em>Uber</em> (HV003) and
the rest for <em>Lyft</em>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NycTrips2022</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/count_pct.html">count_pct</a></span><span class="op">(</span>company <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">hvfhs_license_num</span> <span class="op">==</span> <span class="st">"HV0002"</span> <span class="op">~</span> <span class="st">"Juno"</span>,</span>
<span>                                <span class="va">hvfhs_license_num</span> <span class="op">==</span> <span class="st">"HV0003"</span> <span class="op">~</span> <span class="st">"Uber"</span>,</span>
<span>                                <span class="va">hvfhs_license_num</span> <span class="op">==</span> <span class="st">"HV0004"</span> <span class="op">~</span> <span class="st">"Via"</span>,</span>
<span>                                <span class="va">hvfhs_license_num</span> <span class="op">==</span> <span class="st">"HV0005"</span> <span class="op">~</span> <span class="st">"Lyft"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    company         n   pct pct_cumulative</span></span>
<span><span class="co">#&gt;     &lt;char&gt;     &lt;int&gt; &lt;num&gt;          &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:    Uber 153847310 0.724          0.724</span></span>
<span><span class="co">#&gt; 2:    Lyft  58568773 0.276          1.000</span></span></code></pre></div>
<blockquote>
<p>To improve interpretavility we need to make the same translation
after sampling the data.</p>
</blockquote>
</div>
<div class="section level4">
<h4 id="dispatching_base_num">dispatching_base_num<a class="anchor" aria-label="anchor" href="#dispatching_base_num"></a>
</h4>
<p>For most of the trips the dispatching number are
<strong>B03404</strong> and <strong>B03406</strong>. The remaining codes
represent a small proportion of observations.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NycTrips2022</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/count_pct.html">count_pct</a></span><span class="op">(</span><span class="va">dispatching_base_num</span><span class="op">)</span></span>
<span><span class="co">#&gt;     dispatching_base_num         n   pct pct_cumulative</span></span>
<span><span class="co">#&gt;                   &lt;char&gt;     &lt;int&gt; &lt;num&gt;          &lt;num&gt;</span></span>
<span><span class="co">#&gt;  1:               B03404 153732577 0.724          0.724</span></span>
<span><span class="co">#&gt;  2:               B03406  58568773 0.276          1.000</span></span>
<span><span class="co">#&gt;  3:               B02764     54512 0.000          1.000</span></span>
<span><span class="co">#&gt;  4:               B02872      6078 0.000          1.000</span></span>
<span><span class="co">#&gt;  5:               B02395      4789 0.000          1.000</span></span>
<span><span class="co">#&gt; ---                                                    </span></span>
<span><span class="co">#&gt; 25:               B02878       591 0.000          1.000</span></span>
<span><span class="co">#&gt; 26:               B02879       458 0.000          1.000</span></span>
<span><span class="co">#&gt; 27:               B02875       213 0.000          1.000</span></span>
<span><span class="co">#&gt; 28:               B02883       137 0.000          1.000</span></span>
<span><span class="co">#&gt; 29:               B02865         3 0.000          1.000</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="originating_base_num">originating_base_num<a class="anchor" aria-label="anchor" href="#originating_base_num"></a>
</h4>
<p>For most of the trips the originating number is
<strong>B03404</strong> and the second is missing. The remaining codes
represent a small proportion of observations.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NycTrips2022</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/count_pct.html">count_pct</a></span><span class="op">(</span><span class="va">originating_base_num</span><span class="op">)</span></span>
<span><span class="co">#&gt;     originating_base_num         n   pct pct_cumulative</span></span>
<span><span class="co">#&gt;                   &lt;char&gt;     &lt;int&gt; &lt;num&gt;          &lt;num&gt;</span></span>
<span><span class="co">#&gt;  1:               B03404 153730161 0.724          0.724</span></span>
<span><span class="co">#&gt;  2:                 &lt;NA&gt;  58498724 0.275          0.999</span></span>
<span><span class="co">#&gt;  3:               B03406     71481 0.000          0.999</span></span>
<span><span class="co">#&gt;  4:               B02764     54511 0.000          0.999</span></span>
<span><span class="co">#&gt;  5:               B02872      6078 0.000          0.999</span></span>
<span><span class="co">#&gt; ---                                                    </span></span>
<span><span class="co">#&gt; 33:               B02003        10 0.000          0.999</span></span>
<span><span class="co">#&gt; 34:               B00446         6 0.000          0.999</span></span>
<span><span class="co">#&gt; 35:               B01985         5 0.000          0.999</span></span>
<span><span class="co">#&gt; 36:               B02865         3 0.000          0.999</span></span>
<span><span class="co">#&gt; 37:               B02826         1 0.000          0.999</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="access_a_ride_flag">access_a_ride_flag<a class="anchor" aria-label="anchor" href="#access_a_ride_flag"></a>
</h4>
<p>Must of the trips doesn’t provide any information related to whether
they were administered on behalf of the Metropolitan Transportation
Authority (MTA) and the remaining confirm that there aren’t.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NycTrips2022</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/count_pct.html">count_pct</a></span><span class="op">(</span><span class="va">access_a_ride_flag</span><span class="op">)</span></span>
<span><span class="co">#&gt;    access_a_ride_flag         n   pct pct_cumulative</span></span>
<span><span class="co">#&gt;                &lt;char&gt;     &lt;int&gt; &lt;num&gt;          &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:                    153847310 0.724          0.724</span></span>
<span><span class="co">#&gt; 2:                  N  58568773 0.276          1.000</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="shared_request_flag">shared_request_flag<a class="anchor" aria-label="anchor" href="#shared_request_flag"></a>
</h4>
<p>Most of passengers <strong>don’t request</strong> to a shared/pooled
ride.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NycTrips2022</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/count_pct.html">count_pct</a></span><span class="op">(</span><span class="va">shared_request_flag</span><span class="op">)</span></span>
<span><span class="co">#&gt;    shared_request_flag         n   pct pct_cumulative</span></span>
<span><span class="co">#&gt;                 &lt;char&gt;     &lt;int&gt; &lt;num&gt;          &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:                   N 210564721 0.991          0.991</span></span>
<span><span class="co">#&gt; 2:                   Y   1851362 0.009          1.000</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="shared_match_flag">shared_match_flag<a class="anchor" aria-label="anchor" href="#shared_match_flag"></a>
</h4>
<p>Most of passengers don’t request to a shared/pooled ride, but even
<strong>fewer achieved to share the ride</strong>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NycTrips2022</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/count_pct.html">count_pct</a></span><span class="op">(</span><span class="va">shared_match_flag</span><span class="op">)</span></span>
<span><span class="co">#&gt;    shared_match_flag         n   pct pct_cumulative</span></span>
<span><span class="co">#&gt;               &lt;char&gt;     &lt;int&gt; &lt;num&gt;          &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:                 N 211916075 0.998          0.998</span></span>
<span><span class="co">#&gt; 2:                 Y    500008 0.002          1.000</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="wav_request_flag">wav_request_flag<a class="anchor" aria-label="anchor" href="#wav_request_flag"></a>
</h4>
<p>It’s really <strong>unusual to request a
wheelchair-accessible</strong> vehicle.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NycTrips2022</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/count_pct.html">count_pct</a></span><span class="op">(</span><span class="va">wav_request_flag</span><span class="op">)</span></span>
<span><span class="co">#&gt;    wav_request_flag         n   pct pct_cumulative</span></span>
<span><span class="co">#&gt;              &lt;char&gt;     &lt;int&gt; &lt;num&gt;          &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:                N 212142808 0.999          0.999</span></span>
<span><span class="co">#&gt; 2:                Y    273275 0.001          1.000</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="wav_match_flag">wav_match_flag<a class="anchor" aria-label="anchor" href="#wav_match_flag"></a>
</h4>
<p>It’s really unusual to request a wheelchair-accessible vehicle, but
we have more tips take place in wheelchair-accessible vehicles, so
<strong>it seems that the service has the capacity to meet the
demand</strong>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NycTrips2022</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/count_pct.html">count_pct</a></span><span class="op">(</span><span class="va">wav_match_flag</span><span class="op">)</span></span>
<span><span class="co">#&gt;    wav_match_flag         n   pct pct_cumulative</span></span>
<span><span class="co">#&gt;            &lt;char&gt;     &lt;int&gt; &lt;num&gt;          &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:              N 199779404 0.941          0.941</span></span>
<span><span class="co">#&gt; 2:              Y  12636679 0.059          1.000</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="start_service_zone">start_service_zone<a class="anchor" aria-label="anchor" href="#start_service_zone"></a>
</h4>
<p><strong>96% of trips</strong> start in <em>Boro Zone</em> and
<em>Yellow Zone</em>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TripsZoneDistribution</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/count_pct.html">count_pct</a></span><span class="op">(</span><span class="va">start_service_zone</span>, wt <span class="op">=</span>  <span class="va">n</span><span class="op">)</span></span>
<span><span class="co">#&gt;    start_service_zone         n   pct pct_cumulative</span></span>
<span><span class="co">#&gt;                &lt;char&gt;     &lt;int&gt; &lt;num&gt;          &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:          Boro Zone 129107636 0.608          0.608</span></span>
<span><span class="co">#&gt; 2:        Yellow Zone  75817668 0.357          0.965</span></span>
<span><span class="co">#&gt; 3:           Airports   7480129 0.035          1.000</span></span>
<span><span class="co">#&gt; 4:                N/A     10625 0.000          1.000</span></span>
<span><span class="co">#&gt; 5:                EWR        25 0.000          1.000</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="end_service_zone">end_service_zone<a class="anchor" aria-label="anchor" href="#end_service_zone"></a>
</h4>
<p><strong>91% of trips</strong> start in <em>Boro Zone</em> and
<em>Yellow Zone</em>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TripsZoneDistribution</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/count_pct.html">count_pct</a></span><span class="op">(</span><span class="va">end_service_zone</span>, wt <span class="op">=</span>  <span class="va">n</span><span class="op">)</span></span>
<span><span class="co">#&gt;    end_service_zone         n   pct pct_cumulative</span></span>
<span><span class="co">#&gt;              &lt;char&gt;     &lt;int&gt; &lt;num&gt;          &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:        Boro Zone 124765613 0.587          0.587</span></span>
<span><span class="co">#&gt; 2:      Yellow Zone  69100865 0.325          0.912</span></span>
<span><span class="co">#&gt; 3:              N/A   8659223 0.041          0.953</span></span>
<span><span class="co">#&gt; 4:         Airports   8523273 0.040          0.993</span></span>
<span><span class="co">#&gt; 5:              EWR   1367109 0.006          0.999</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="start_borough">start_borough<a class="anchor" aria-label="anchor" href="#start_borough"></a>
</h4>
<p><strong>87% of trips</strong> start in <em>Manhattan</em>,
<em>Brooklyn</em> or <em>Queens</em>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TripsZoneDistribution</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/count_pct.html">count_pct</a></span><span class="op">(</span><span class="va">start_borough</span>, wt <span class="op">=</span>  <span class="va">n</span><span class="op">)</span></span>
<span><span class="co">#&gt;    start_borough        n   pct pct_cumulative</span></span>
<span><span class="co">#&gt;           &lt;char&gt;    &lt;int&gt; &lt;num&gt;          &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:     Manhattan 88031630 0.414          0.414</span></span>
<span><span class="co">#&gt; 2:      Brooklyn 54874948 0.258          0.672</span></span>
<span><span class="co">#&gt; 3:        Queens 41897696 0.197          0.869</span></span>
<span><span class="co">#&gt; 4:         Bronx 24797734 0.117          0.986</span></span>
<span><span class="co">#&gt; 5: Staten Island  2803425 0.013          0.999</span></span>
<span><span class="co">#&gt; 6:       Unknown    10625 0.000          0.999</span></span>
<span><span class="co">#&gt; 7:           EWR       25 0.000          0.999</span></span></code></pre></div>
</div>
<div class="section level4 tabset">
<h4 class="tabset" id="start_zone">start_zone<a class="anchor" aria-label="anchor" href="#start_zone"></a>
</h4>
<p>To gain a deeper understanding of the starting trips at the zone
level, we’ll create a <strong>wrapper function</strong> to display the
top 5 most significant zones and generate an interactive map.</p>
<p>The map will illustrate the location of each zone in relation to the
remaining locations within each borough.</p>



<ul class="nav nav-tabs" id="start_zone" role="tablist">
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#manhattan" id="manhattan-tab" type="button" role="tab" aria-controls="manhattan" aria-selected="true" class="active nav-link">Manhattan</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#brooklyn" id="brooklyn-tab" type="button" role="tab" aria-controls="brooklyn" aria-selected="false" class="nav-link">Brooklyn</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#queens" id="queens-tab" type="button" role="tab" aria-controls="queens" aria-selected="false" class="nav-link">Queens</button></li>
</ul>
<div class="tab-content">
<div class="active  tab-pane" id="manhattan" role="tabpanel" aria-labelledby="manhattan-tab">

<p>Here we can see how the <em>East Village</em> zone is surrounded by
<em>(Meatpacking) West Village</em> and <em>Clinton (East|West)</em>, so
most of the activity happens in those places. The remaining top zones (
<em>Upper East Side (North|South)</em> and <em>Central Harlem
(North)</em> ) are surrounding the <strong>Central Park</strong>.</p>
<p>All these places are very popular for local and international
tourist.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/highlight_top_zones.html">highlight_top_zones</a></span><span class="op">(</span><span class="va">TripsZoneDistribution</span>,</span>
<span>                    borough <span class="op">=</span> <span class="st">"Manhattan"</span>,</span>
<span>                    borough_color <span class="op">=</span> <span class="va">BoroughColors</span><span class="op">[[</span><span class="st">"Manhattan"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                    top_color <span class="op">=</span> <span class="st">"purple"</span>,</span>
<span>                    col_prefix  <span class="op">=</span> <span class="st">"start_"</span><span class="op">)</span></span>
<span><span class="co">#&gt;                       start_zone start_long start_lat million_trips</span></span>
<span><span class="co">#&gt;                           &lt;char&gt;      &lt;num&gt;     &lt;num&gt;         &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:    (Meatpacking) West Village     -74.00     40.73         3.722</span></span>
<span><span class="co">#&gt; 2:           Clinton (East|West)     -73.99     40.71         3.700</span></span>
<span><span class="co">#&gt; 3: Upper East Side (North|South)     -73.96     40.77         3.455</span></span>
<span><span class="co">#&gt; 4:        Central Harlem (North)     -73.96     40.80         3.281</span></span>
<span><span class="co">#&gt; 5:                  East Village     -73.98     40.73         3.204</span></span></code></pre></div>
<div class="leaflet html-widget html-fill-item" id="htmlwidget-36aa3d2a04d42bbc2145" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-36aa3d2a04d42bbc2145">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addProviderTiles","args":["CartoDB",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[40.73497,40.714099893777,40.77062,40.799418619169,40.72804,40.711474728456,40.756901597587,40.815707125937,40.821068764756,40.773243152153,40.7588,40.744915240463,40.71337,40.79251,40.73687,40.71693,40.75431,40.75422,40.74855,40.77808,40.70906,40.80788,40.73773520932,40.757375,40.71891,40.742685475578,40.74098,40.84231,40.7252,40.758012125134,40.74919,40.7544,40.74213,40.85546,40.71131,40.71192,40.82238,40.81053,40.70969,40.723440011834,40.72599,40.86596,40.808845814501,40.71646,40.734872337033,40.707149992561,40.78343,40.76748,40.76187,40.87641,40.76456,40.86987,40.70444,40.795284230642,40.84173,40.70267],[-74.00483,-73.98715424302,-73.95703,-73.95524522581501,-73.98499,-74.01226522787201,-73.990038822312,-73.934448114471,-73.93568412261899,-73.98183992156299,-73.97291,-74.00248044924901,-74.0038,-73.97320000000001,-73.98996,-73.98423,-74.00118999999999,-73.99245000000001,-73.97605,-73.9485,-74.01061,-73.94542,-73.984524819086,-73.96938299999999,-73.99609,-73.989204217904,-73.98967,-73.93924,-74.00415,-73.960200066821,-73.96795,-73.99185,-73.97781000000001,-73.93379,-74.0159,-73.99692,-73.94968,-73.96205999999999,-74.01167,-74.006164997819,-73.98057,-73.92610000000001,-73.954033071144,-73.99675999999999,-73.977029887165,-74.00452503655301,-73.96625,-73.97069,-73.96637,-73.911,-73.94732,-73.92094,-74.01425,-73.921313367379,-73.9355,-74.01424],[10,9.941235047449945,9.284816823704604,8.815468375749608,8.608283628089593,7.972756922683379,7.629437398800411,7.424902044977357,7.325807729243772,7.158766940938939,7.070952701602481,6.99296755218043,6.921224331646069,6.869923898445994,6.555272105644714,6.413784801507736,6.313118583751208,6.311288728575781,5.685051023670963,5.452183815266849,5.410884440749504,5.153103257034733,4.909509496706529,4.798455290538547,4.54656672415081,4.430503927605448,4.28564711041416,4.209927112112352,3.818700851191663,3.755819396249898,3.581784315695966,3.557622703746715,3.312113103858925,2.950008679048776,2.776782389108358,2.668296966417187,2.58025970508431,2.499918046133846,2.286835307122785,2.043327531178744,1.974394925201647,1.940191949389592,1.729535582219075,1.478291898712545,1.372904600863176,1.368747793291391,1.304146650666406,0.9621975029060036,0.8305903419115297,0.5165296917513568,0.3944506753267273,0.1381580962627425,0.08694902147083813,0.07643205648314196,0.04510149650446608,0.0001155415162163862],null,null,{"interactive":true,"className":"","stroke":true,"color":["#A020F0","#A020F0","#A020F0","#A020F0","#A020F0","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C"],"weight":5,"opacity":0.5,"fill":true,"fillColor":["#A020F0","#A020F0","#A020F0","#A020F0","#A020F0","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C"],"fillOpacity":0.2},null,null,null,null,["(Meatpacking) West Village","Clinton (East|West)","Upper East Side (North|South)","Central Harlem (North)","East Village","Greenwich Village (North|South)","Times Sq/Theatre District","East Harlem (North|South)","Lenox Hill (East|West)","Lincoln Square (East|West)","Midtown Center","East Chelsea","TriBeCa/Civic Center","Upper West Side (North|South)","Union Sq","Lower East Side","West Chelsea/Hudson Yards","Midtown South","Murray Hill","Yorkville (East|West)","Financial District (North|South)","Midtown North","Gramercy","Midtown East","Little Italy/NoLiTa","Penn Station/Madison Sq West","Flatiron","Washington Heights South","SoHo","Sutton Place/Turtle Bay North","UN/Turtle Bay South","Garment District","Kips Bay","Washington Heights North","Battery Park City","Two Bridges/Seward Park","Hamilton Heights","Morningside Heights","World Trade Center","Hudson Sq","Alphabet City","Inwood","Manhattan Valley","Chinatown","Stuy Town/Peter Cooper Village","Seaport","Manhattanville","Central Park","Bloomingdale","Marble Hill","Roosevelt Island","Inwood Hill Park","Battery Park","Randalls Island","Highbridge Park","Governor's Island/Ellis Island/Liberty Island"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["#E41A1C","#A020F0"],"labels":["Manhattan","TOP 5"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"topleft","type":"factor","title":null,"extra":null,"layerId":null,"className":"info legend","group":null}]}],"limits":{"lat":[40.70267,40.87641],"lng":[-74.0159,-73.911]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="tab-pane" id="brooklyn" role="tabpanel" aria-labelledby="brooklyn-tab">

<p>In this Borough, the most important starting zones are concentrated
in the north part. <em>Bushwick (North|South)</em>, <em>Crown Heights
(North|South)</em>, <em>Williamsburg (North Side)</em> and <em>Park
Slope</em> form an <strong>“U”</strong> shape, the farthest zone is the
<em>East New York</em>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/highlight_top_zones.html">highlight_top_zones</a></span><span class="op">(</span><span class="va">TripsZoneDistribution</span>,</span>
<span>                    borough <span class="op">=</span> <span class="st">"Brooklyn"</span>,</span>
<span>                    borough_color <span class="op">=</span> <span class="va">BoroughColors</span><span class="op">[[</span><span class="st">"Brooklyn"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                    top_color <span class="op">=</span> <span class="st">"purple"</span>,</span>
<span>                    col_prefix  <span class="op">=</span> <span class="st">"start_"</span><span class="op">)</span></span>
<span><span class="co">#&gt;                     start_zone start_long start_lat million_trips</span></span>
<span><span class="co">#&gt;                         &lt;char&gt;      &lt;num&gt;     &lt;num&gt;         &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:      Bushwick (North|South)     -73.92     40.69         4.024</span></span>
<span><span class="co">#&gt; 2: Crown Heights (North|South)     -73.95     40.67         3.549</span></span>
<span><span class="co">#&gt; 3:               East New York     -73.88     40.67         2.201</span></span>
<span><span class="co">#&gt; 4:   Williamsburg (North Side)     -73.95     40.71         2.178</span></span>
<span><span class="co">#&gt; 5:                  Park Slope     -73.99     40.67         1.985</span></span></code></pre></div>
<div class="leaflet html-widget html-fill-item" id="htmlwidget-febe03efa1a2d8d52a86" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-febe03efa1a2d8d52a86">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addProviderTiles","args":["CartoDB",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[40.692740347359,40.666352822692,40.66643,40.71478,40.67044,40.65379,40.7304,40.698337835102,40.67955071693,40.681979438148,40.708,40.64031,40.65061,40.57832998949,40.64364,40.69319,40.68682,40.6629,40.60186,40.68372,40.583930001866,40.6339,40.63382,40.62114,40.69535,40.69363,40.70198,40.67747,40.649654095456,40.67794,40.59094,40.62326,40.647533853812,40.586449859123,40.61109,40.6802,40.5755,40.683899997121,40.67236,40.64626,40.57795,40.67502,40.62133,40.68978,40.65397,40.700050978728,40.59757,40.65014,40.60463,40.57737,40.678784667421,40.66047,40.684446717712,40.589547496498,40.659099],[-73.923882116434,-73.952248666071,-73.88269,-73.95276,-73.98718,-73.93080999999999,-73.95204,-73.962760026992,-73.954254134186,-73.93184794067901,-73.93989999999999,-73.96183000000001,-73.95386999999999,-74.011444968177,-73.90069,-73.97168000000001,-73.96469999999999,-73.91728999999999,-73.9939,-73.98179,-73.966749978236,-74.0149,-73.99693000000001,-73.93528000000001,-73.99405,-73.98287999999999,-73.98282,-73.96583,-73.952625064858,-73.89163000000001,-73.94493,-73.95653,-73.881531762325,-73.956891156328,-73.90957,-74.00163000000001,-73.97845,-73.95761500297,-73.99027,-73.97108,-73.9601,-74.01023000000001,-74.00995,-73.99817,-73.97785,-73.962456578249,-73.96541999999999,-73.88444,-74.00462,-73.94774,-73.94408377330601,-73.96278,-74.002963871067,-73.882072620519,-73.996138],[10,8.820709663420995,5.470005937597318,5.413694450595785,4.934411793872668,4.79716605861594,4.602833394598203,4.465957982489431,4.361561650229538,4.332470157297863,4.324755505947166,4.159298105908941,3.894984308488627,3.68365654590901,3.658380127018354,3.316450077332918,3.10311660481773,3.048520037091964,2.965411072363877,2.945587599692109,2.769460419290307,2.722148530401169,2.522213796749258,2.477198408455496,2.468477174051631,2.357447335201849,1.900545617722622,1.811317622187377,1.592307518330374,1.575096190816334,1.558053869839615,1.557469803129753,1.489728006346692,1.447548448333583,1.434003071445277,1.282240171710642,1.276429329295071,1.1432546632756,1.107437704314613,1.010467718135868,0.9619131341193627,0.9468069321510828,0.852585787594075,0.7845010069558617,0.7638101330851919,0.7625699233480792,0.7065293438843121,0.6031296531165674,0.5555891083239944,0.535805401896303,0.4468234599962768,0.3113721765034685,0.2858571601483579,0.04843777067453242,0.01811352417650943],null,null,{"interactive":true,"className":"","stroke":true,"color":["#A020F0","#A020F0","#A020F0","#A020F0","#A020F0","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A"],"weight":5,"opacity":0.5,"fill":true,"fillColor":["#A020F0","#A020F0","#A020F0","#A020F0","#A020F0","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A"],"fillOpacity":0.2},null,null,null,null,["Bushwick (North|South)","Crown Heights (North|South)","East New York","Williamsburg (North Side)","Park Slope","East Flatbush (Farragut|Remsen Village)","Greenpoint","Williamsburg (South Side)","Bedford","Stuyvesant Heights","East Williamsburg","Flatbush/Ditmas Park","Prospect-Lefferts Gardens","Sunset Park (East|West)","Canarsie","Fort Greene","Clinton Hill","Brownsville","Bensonhurst (East|West)","Boerum Hill","Ocean (Hill|Parkway South)","Bay Ridge","Borough Park","Flatlands","Brooklyn Heights","Downtown Brooklyn/MetroTech","DUMBO/Vinegar Hill","Prospect Heights","Erasmus","Cypress Hills","Sheepshead Bay","Midwood","East New York/Pennsylvania Avenue","Homecrest","Marine Park/Mill Basin","Carroll Gardens","Coney Island","Madison","Gowanus","Kensington","Brighton Beach","Red Hook","Dyker Heights","Cobble Hill","Windsor Terrace","South Williamsburg","Gravesend","Starrett City","Bath Beach","Manhattan Beach","Brooklyn Navy Yard","Prospect Park","Columbia Street","Marine Park/Floyd Bennett Field","Green-Wood Cemetery"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["#4DAF4A","#A020F0"],"labels":["Brooklyn","TOP 5"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"topleft","type":"factor","title":null,"extra":null,"layerId":null,"className":"info legend","group":null}]}],"limits":{"lat":[40.5755,40.7304],"lng":[-74.0149,-73.881531762325]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="tab-pane" id="queens" role="tabpanel" aria-labelledby="queens-tab">

<p>Most of the most important starting zones are concentrated in north
part of this Borough and the only exception is the <em>JFK Airport</em>
in the south.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/highlight_top_zones.html">highlight_top_zones</a></span><span class="op">(</span><span class="va">TripsZoneDistribution</span>,</span>
<span>                    borough <span class="op">=</span> <span class="st">"Queens"</span>,</span>
<span>                    borough_color <span class="op">=</span> <span class="va">BoroughColors</span><span class="op">[[</span><span class="st">"Queens"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                    top_color <span class="op">=</span> <span class="st">"purple"</span>,</span>
<span>                    col_prefix  <span class="op">=</span> <span class="st">"start_"</span><span class="op">)</span></span>
<span><span class="co">#&gt;                        start_zone start_long start_lat million_trips</span></span>
<span><span class="co">#&gt;                            &lt;char&gt;      &lt;num&gt;     &lt;num&gt;         &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:              LaGuardia Airport     -73.87     40.78         3.826</span></span>
<span><span class="co">#&gt; 2:                    JFK Airport     -73.79     40.64         3.654</span></span>
<span><span class="co">#&gt; 3:                  (Old) Astoria     -73.93     40.77         2.821</span></span>
<span><span class="co">#&gt; 4:             Elmhurst (Maspeth)     -73.88     40.74         1.826</span></span>
<span><span class="co">#&gt; 5: Long Island City/Hunters Point     -73.96     40.75         1.675</span></span></code></pre></div>
<div class="leaflet html-widget html-fill-item" id="htmlwidget-1fb4450895fe099f74a1" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-1fb4450895fe099f74a1">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addProviderTiles","args":["CartoDB",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[40.77572,40.64459,40.77205,40.74361,40.74829,40.7494,40.70179,40.72267,40.70074,40.74244,40.67544,40.77376,40.76358,40.74696,40.70055,40.69329,40.758916614532,40.67302,40.69263,40.68094,40.74637,40.72729,40.745378,40.71481,40.73194,40.71336,40.70141,40.75306,40.76439,40.72696,40.70865,40.71238,40.77731,40.76583,40.60401,40.66692,40.65954,40.73064,40.68012,40.71795,40.75647,40.588138,40.65483,40.7841,40.78863,40.74292,40.7188,40.69254,40.75566,40.74162,40.75861,40.748,40.72304,40.74612,40.74905,40.77978,40.5799,40.76863,40.766414,40.70344,40.786790508562,40.56478,40.60315,40.7763,40.61703],[-73.87452999999999,-73.79436,-73.92606000000001,-73.88433000000001,-73.9575,-73.88755999999999,-73.80853,-73.84791,-73.89509,-73.92074,-73.81113999999999,-73.90494,-73.83004,-73.90279,-73.82805999999999,-73.75644,-73.76222747739401,-73.78543000000001,-73.86102,-73.79089,-73.85483000000001,-73.89543999999999,-73.932194,-73.75076,-73.86884000000001,-73.79886999999999,-73.88720000000001,-73.86118999999999,-73.87402,-73.79832,-73.82890999999999,-73.8827,-73.78068,-73.80842,-73.75248999999999,-73.75215,-73.73994,-73.82408,-73.84735999999999,-73.78269,-73.94729,-73.81196300000001,-73.84602,-73.84581,-73.81373000000001,-73.82061,-73.76465,-73.73184999999999,-73.81028000000001,-73.78299,-73.78574,-73.71324,-73.71545999999999,-73.85279,-73.75668,-73.77867999999999,-73.83692000000001,-73.74733999999999,-73.896908,-73.85041,-73.792776615931,-73.89296,-73.8214,-73.92361,-73.82461000000001],[10,9.549166874873901,7.373593817133766,4.771234262930715,4.378122455123937,4.098495785502295,3.534219337869637,3.43286858691232,3.27341233708873,3.244504635790666,3.201588682168436,2.622188026289517,2.608218976164018,2.283865211341667,2.279918856675716,2.143257378637833,2.109755179655836,1.780537728718695,1.708225353055001,1.689426592053558,1.672546125306953,1.55734131734023,1.468459479039368,1.460302808236434,1.338407491696975,1.291419736373054,1.257622214161089,1.213945737884691,1.157601724478585,1.144746016795267,1.135847117697545,1.127823734370083,1.045603656362935,0.99544836338661,0.9792500148968355,0.9737015970453042,0.9550413504791555,0.9332553819391811,0.8519265005817607,0.8305848236266946,0.7946625422469029,0.7774815253105076,0.7461798764137619,0.7289465898791423,0.6625093170558836,0.6492249986671252,0.6099835978000772,0.5819305044329847,0.5247449504954635,0.4720571954851612,0.4480706768599352,0.4376141437351228,0.4300873215907938,0.4223592614933006,0.3873543115623488,0.3479012188224914,0.3410669688546372,0.3372931038628279,0.1154661559578456,0.07363740997868447,0.05000371114147395,0.04242984635874297,0.02344814176351353,0.01952008145694187,0.001338101714547361],null,null,{"interactive":true,"className":"","stroke":true,"color":["#A020F0","#A020F0","#A020F0","#A020F0","#A020F0","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8"],"weight":5,"opacity":0.5,"fill":true,"fillColor":["#A020F0","#A020F0","#A020F0","#A020F0","#A020F0","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8"],"fillOpacity":0.2},null,null,null,null,["LaGuardia Airport","JFK Airport","(Old) Astoria","Elmhurst (Maspeth)","Long Island City/Hunters Point","Jackson Heights","Jamaica","Forest Hills","Ridgewood","Sunnyside","South Ozone Park","Steinway","Flushing","Woodside","Richmond Hill","Saint Albans","Springfield Gardens (North|South)","Baisley Park","Woodhaven","South Jamaica","Corona","Maspeth","Long Island City/Queens Plaza","Queens Village","Rego Park","Briarwood/Jamaica Hills","Glendale","North Corona","East Elmhurst","Hillcrest/Pomonok","Kew Gardens","Middle Village","Bayside","Murray Hill-Queens","Far Rockaway","Laurelton","Rosedale","Kew Gardens Hills","Ozone Park","Jamaica Estates","Queensbridge/Ravenswood","Hammels/Arverne","Howard Beach","College Point","Whitestone","Queensboro Hill","Hollis","Cambria Heights","East Flushing","Fresh Meadows","Auburndale","Glen Oaks","Bellerose","Flushing Meadows-Corona Park","Oakland Gardens","Bay Terrace/Fort Totten","Rockaway Park","Douglaston","Saint Michaels Cemetery/Woodside","Forest Park/Highland Park","Willets Point","Breezy Point/Fort Tilden/Riis Beach","Broad Channel","Astoria Park","Jamaica Bay"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["#377EB8","#A020F0"],"labels":["Queens","TOP 5"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"topleft","type":"factor","title":null,"extra":null,"layerId":null,"className":"info legend","group":null}]}],"limits":{"lat":[40.56478,40.78863],"lng":[-73.9575,-73.71324]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div class="section level4">
<h4 id="end_borough">end_borough<a class="anchor" aria-label="anchor" href="#end_borough"></a>
</h4>
<p><strong>82% of trips</strong> end in <em>Manhattan</em>,
<em>Brooklyn</em> or <em>Queens</em>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TripsZoneDistribution</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/count_pct.html">count_pct</a></span><span class="op">(</span><span class="va">end_borough</span>, wt <span class="op">=</span>  <span class="va">n</span><span class="op">)</span></span>
<span><span class="co">#&gt; Index: &lt;start_borough&gt;</span></span>
<span><span class="co">#&gt;      end_borough        n   pct pct_cumulative</span></span>
<span><span class="co">#&gt;           &lt;char&gt;    &lt;int&gt; &lt;num&gt;          &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:     Manhattan 80967388 0.381          0.381</span></span>
<span><span class="co">#&gt; 2:      Brooklyn 54143716 0.255          0.636</span></span>
<span><span class="co">#&gt; 3:        Queens 40982171 0.193          0.829</span></span>
<span><span class="co">#&gt; 4:         Bronx 23541369 0.111          0.940</span></span>
<span><span class="co">#&gt; 5:       Unknown  8659223 0.041          0.981</span></span>
<span><span class="co">#&gt; 6: Staten Island  2755107 0.013          0.994</span></span>
<span><span class="co">#&gt; 7:           EWR  1367109 0.006          1.000</span></span></code></pre></div>
</div>
<div class="section level4 tabset">
<h4 class="tabset" id="end_zone">end_zone<a class="anchor" aria-label="anchor" href="#end_zone"></a>
</h4>



<ul class="nav nav-tabs" id="end_zone" role="tablist">
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#manhattan-1" id="manhattan-1-tab" type="button" role="tab" aria-controls="manhattan-1" aria-selected="true" class="active nav-link">Manhattan</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#brooklyn-1" id="brooklyn-1-tab" type="button" role="tab" aria-controls="brooklyn-1" aria-selected="false" class="nav-link">Brooklyn</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#queens-1" id="queens-1-tab" type="button" role="tab" aria-controls="queens-1" aria-selected="false" class="nav-link">Queens</button></li>
</ul>
<div class="tab-content">
<div class="active  tab-pane" id="manhattan-1" role="tabpanel" aria-labelledby="manhattan-1-tab">

<p>If we focus our attention to the places where the trips end we see
the new zone <em>East Harlem (North|South)</em> which get the top 5
moving the <em>East Village</em> to the sixth position.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/highlight_top_zones.html">highlight_top_zones</a></span><span class="op">(</span><span class="va">TripsZoneDistribution</span>,</span>
<span>                    borough <span class="op">=</span> <span class="st">"Manhattan"</span>,</span>
<span>                    borough_color <span class="op">=</span> <span class="va">BoroughColors</span><span class="op">[[</span><span class="st">"Manhattan"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                    top_length <span class="op">=</span> <span class="fl">6</span>,</span>
<span>                    top_color <span class="op">=</span> <span class="st">"purple"</span>,</span>
<span>                    col_prefix  <span class="op">=</span> <span class="st">"end_"</span><span class="op">)</span></span>
<span><span class="co">#&gt;                         end_zone end_long end_lat million_trips</span></span>
<span><span class="co">#&gt;                           &lt;char&gt;    &lt;num&gt;   &lt;num&gt;         &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: Upper East Side (North|South)   -73.96   40.77         3.418</span></span>
<span><span class="co">#&gt; 2:    (Meatpacking) West Village   -74.00   40.73         3.178</span></span>
<span><span class="co">#&gt; 3:           Clinton (East|West)   -73.99   40.71         3.144</span></span>
<span><span class="co">#&gt; 4:        Central Harlem (North)   -73.96   40.80         3.045</span></span>
<span><span class="co">#&gt; 5:     East Harlem (North|South)   -73.93   40.82         2.728</span></span>
<span><span class="co">#&gt; 6:                  East Village   -73.98   40.73         2.681</span></span></code></pre></div>
<div class="leaflet html-widget html-fill-item" id="htmlwidget-10b3b7155e8045a1b2ad" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-10b3b7155e8045a1b2ad">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addProviderTiles","args":["CartoDB",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[40.77062,40.73497,40.714099893777,40.799418619169,40.815707125937,40.72804,40.756901597587,40.821068764756,40.711474728456,40.7588,40.744915240463,40.773243152153,40.79251,40.75431,40.71337,40.73687,40.74855,40.742685475578,40.75422,40.71693,40.70906,40.757375,40.77808,40.80788,40.73773520932,40.84231,40.71891,40.74098,40.7252,40.74919,40.74213,40.7544,40.758012125134,40.85546,40.71131,40.81053,40.82238,40.71192,40.70969,40.86596,40.723440011834,40.72599,40.808845814501,40.78343,40.76748,40.71646,40.707149992561,40.734872337033,40.76187,40.87641,40.76456,40.795284230642,40.86987,40.70444,40.84173,40.70267],[-73.95703,-74.00483,-73.98715424302,-73.95524522581501,-73.934448114471,-73.98499,-73.990038822312,-73.93568412261899,-74.01226522787201,-73.97291,-74.00248044924901,-73.98183992156299,-73.97320000000001,-74.00118999999999,-74.0038,-73.98996,-73.97605,-73.989204217904,-73.99245000000001,-73.98423,-74.01061,-73.96938299999999,-73.9485,-73.94542,-73.984524819086,-73.93924,-73.99609,-73.98967,-74.00415,-73.96795,-73.97781000000001,-73.99185,-73.960200066821,-73.93379,-74.0159,-73.96205999999999,-73.94968,-73.99692,-74.01167,-73.92610000000001,-74.006164997819,-73.98057,-73.954033071144,-73.96625,-73.97069,-73.99675999999999,-74.00452503655301,-73.977029887165,-73.96637,-73.911,-73.94732,-73.921313367379,-73.92094,-74.01425,-73.9355,-74.01424],[10,9.299665303478369,9.198533643598383,8.909978953823934,7.982355503942244,7.845214489295945,7.790704512916934,7.613817737716017,7.468882059780737,7.42106367309463,7.020492883712342,6.881605092045201,6.815435305903961,6.57921370456295,6.456872016836941,6.451344945157931,6.053583043447349,6.02919253549805,5.96927252442635,5.605085608166607,5.576104324428867,5.342197129492354,5.2756030842757,4.954280964256027,4.797855180188682,4.556542469942707,4.143156130558269,3.950773658368452,3.852310441776586,3.544067204978285,3.53902291086785,3.372888908785177,3.326079966106088,2.999754514921192,2.914531107406891,2.855544466301101,2.691625389184554,2.557913558237458,2.397792331327027,2.083577282301696,1.939036604195249,1.754750165534187,1.700257744703125,1.472044399151131,1.470862325589289,1.467874956513445,1.428339862534208,1.216254213697248,0.8391288585997169,0.4680601675442977,0.4622639107967497,0.216895868974753,0.1675325940692092,0.1055790653601828,0.07127259874483684,0.000389147979517357],null,null,{"interactive":true,"className":"","stroke":true,"color":["#A020F0","#A020F0","#A020F0","#A020F0","#A020F0","#A020F0","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C"],"weight":5,"opacity":0.5,"fill":true,"fillColor":["#A020F0","#A020F0","#A020F0","#A020F0","#A020F0","#A020F0","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C","#E41A1C"],"fillOpacity":0.2},null,null,null,null,["Upper East Side (North|South)","(Meatpacking) West Village","Clinton (East|West)","Central Harlem (North)","East Harlem (North|South)","East Village","Times Sq/Theatre District","Lenox Hill (East|West)","Greenwich Village (North|South)","Midtown Center","East Chelsea","Lincoln Square (East|West)","Upper West Side (North|South)","West Chelsea/Hudson Yards","TriBeCa/Civic Center","Union Sq","Murray Hill","Penn Station/Madison Sq West","Midtown South","Lower East Side","Financial District (North|South)","Midtown East","Yorkville (East|West)","Midtown North","Gramercy","Washington Heights South","Little Italy/NoLiTa","Flatiron","SoHo","UN/Turtle Bay South","Kips Bay","Garment District","Sutton Place/Turtle Bay North","Washington Heights North","Battery Park City","Morningside Heights","Hamilton Heights","Two Bridges/Seward Park","World Trade Center","Inwood","Hudson Sq","Alphabet City","Manhattan Valley","Manhattanville","Central Park","Chinatown","Seaport","Stuy Town/Peter Cooper Village","Bloomingdale","Marble Hill","Roosevelt Island","Randalls Island","Inwood Hill Park","Battery Park","Highbridge Park","Governor's Island/Ellis Island/Liberty Island"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["#E41A1C","#A020F0"],"labels":["Manhattan","TOP 6"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"topleft","type":"factor","title":null,"extra":null,"layerId":null,"className":"info legend","group":null}]}],"limits":{"lat":[40.70267,40.87641],"lng":[-74.0159,-73.911]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="tab-pane" id="brooklyn-1" role="tabpanel" aria-labelledby="brooklyn-1-tab">

<p>We also can see the same pattern from the ending zone
perspective.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/highlight_top_zones.html">highlight_top_zones</a></span><span class="op">(</span><span class="va">TripsZoneDistribution</span>,</span>
<span>                    borough <span class="op">=</span> <span class="st">"Brooklyn"</span>,</span>
<span>                    borough_color <span class="op">=</span> <span class="va">BoroughColors</span><span class="op">[[</span><span class="st">"Brooklyn"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                    top_color <span class="op">=</span> <span class="st">"purple"</span>,</span>
<span>                    col_prefix  <span class="op">=</span> <span class="st">"end_"</span><span class="op">)</span></span>
<span><span class="co">#&gt;                       end_zone end_long end_lat million_trips</span></span>
<span><span class="co">#&gt;                         &lt;char&gt;    &lt;num&gt;   &lt;num&gt;         &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:      Bushwick (North|South)   -73.92   40.69         4.028</span></span>
<span><span class="co">#&gt; 2: Crown Heights (North|South)   -73.95   40.67         3.660</span></span>
<span><span class="co">#&gt; 3:               East New York   -73.88   40.67         2.187</span></span>
<span><span class="co">#&gt; 4:   Williamsburg (North Side)   -73.95   40.71         2.026</span></span>
<span><span class="co">#&gt; 5:                  Park Slope   -73.99   40.67         1.947</span></span></code></pre></div>
<div class="leaflet html-widget html-fill-item" id="htmlwidget-4018eef1a407a0df6b52" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-4018eef1a407a0df6b52">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addProviderTiles","args":["CartoDB",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[40.692740347359,40.666352822692,40.66643,40.71478,40.67044,40.65379,40.681979438148,40.67955071693,40.7304,40.64031,40.698337835102,40.708,40.65061,40.57832998949,40.64364,40.69319,40.68682,40.60186,40.6629,40.6339,40.68372,40.583930001866,40.63382,40.69535,40.62114,40.69363,40.67747,40.70198,40.649654095456,40.59094,40.67794,40.62326,40.61109,40.647533853812,40.586449859123,40.5755,40.6802,40.683899997121,40.64626,40.57795,40.67236,40.67502,40.62133,40.65397,40.700050978728,40.59757,40.68978,40.57737,40.65014,40.60463,40.678784667421,40.66047,40.684446717712,40.589547496498,40.659099],[-73.923882116434,-73.952248666071,-73.88269,-73.95276,-73.98718,-73.93080999999999,-73.93184794067901,-73.954254134186,-73.95204,-73.96183000000001,-73.962760026992,-73.93989999999999,-73.95386999999999,-74.011444968177,-73.90069,-73.97168000000001,-73.96469999999999,-73.9939,-73.91728999999999,-74.0149,-73.98179,-73.966749978236,-73.99693000000001,-73.99405,-73.93528000000001,-73.98287999999999,-73.96583,-73.98282,-73.952625064858,-73.94493,-73.89163000000001,-73.95653,-73.90957,-73.881531762325,-73.956891156328,-73.97845,-74.00163000000001,-73.95761500297,-73.97108,-73.9601,-73.99027,-74.01023000000001,-74.00995,-73.97785,-73.962456578249,-73.96541999999999,-73.99817,-73.94774,-73.88444,-74.00462,-73.94408377330601,-73.96278,-74.002963871067,-73.882072620519,-73.996138],[10,9.085693147229549,5.430379903968857,5.029328228885811,4.833738014727425,4.667704438585254,4.521021088121237,4.457759207122393,4.450303635180965,4.205133743476686,4.16363279756496,4.125438818628255,3.9690828380331,3.771590869593283,3.505151618973847,3.204222589662998,3.094395038556454,2.888918681384159,2.860062167006798,2.745557194142796,2.718378990332335,2.696104134701802,2.571663364665108,2.378866196938325,2.330187742374363,2.196533643175284,1.79210796800286,1.717303977794661,1.584131523935788,1.514794456609714,1.511489972342634,1.504007090613875,1.484411076849742,1.464427760647093,1.462533454489481,1.311991975887941,1.217107843867463,1.131950961552785,1.009272914152925,0.9966160690788657,0.9948806562293627,0.9490175924684573,0.8537809159206131,0.8133351208830497,0.8020363170517347,0.697117079540997,0.6858505509128919,0.6016073051198404,0.5583039132442538,0.5412104690828381,0.5197648379039987,0.4485607742076438,0.2741977129294464,0.05963216199172762,0.02074302483204481],null,null,{"interactive":true,"className":"","stroke":true,"color":["#A020F0","#A020F0","#A020F0","#A020F0","#A020F0","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A"],"weight":5,"opacity":0.5,"fill":true,"fillColor":["#A020F0","#A020F0","#A020F0","#A020F0","#A020F0","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A","#4DAF4A"],"fillOpacity":0.2},null,null,null,null,["Bushwick (North|South)","Crown Heights (North|South)","East New York","Williamsburg (North Side)","Park Slope","East Flatbush (Farragut|Remsen Village)","Stuyvesant Heights","Bedford","Greenpoint","Flatbush/Ditmas Park","Williamsburg (South Side)","East Williamsburg","Prospect-Lefferts Gardens","Sunset Park (East|West)","Canarsie","Fort Greene","Clinton Hill","Bensonhurst (East|West)","Brownsville","Bay Ridge","Boerum Hill","Ocean (Hill|Parkway South)","Borough Park","Brooklyn Heights","Flatlands","Downtown Brooklyn/MetroTech","Prospect Heights","DUMBO/Vinegar Hill","Erasmus","Sheepshead Bay","Cypress Hills","Midwood","Marine Park/Mill Basin","East New York/Pennsylvania Avenue","Homecrest","Coney Island","Carroll Gardens","Madison","Kensington","Brighton Beach","Gowanus","Red Hook","Dyker Heights","Windsor Terrace","South Williamsburg","Gravesend","Cobble Hill","Manhattan Beach","Starrett City","Bath Beach","Brooklyn Navy Yard","Prospect Park","Columbia Street","Marine Park/Floyd Bennett Field","Green-Wood Cemetery"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["#4DAF4A","#A020F0"],"labels":["Brooklyn","TOP 5"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"topleft","type":"factor","title":null,"extra":null,"layerId":null,"className":"info legend","group":null}]}],"limits":{"lat":[40.5755,40.7304],"lng":[-74.0149,-73.881531762325]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="tab-pane" id="queens-1" role="tabpanel" aria-labelledby="queens-1-tab">

<p>For the ending perspective, now the <em>JFK Airport</em> present more
trips than the <em>LaGuardia Airport</em>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/highlight_top_zones.html">highlight_top_zones</a></span><span class="op">(</span><span class="va">TripsZoneDistribution</span>,</span>
<span>                    borough <span class="op">=</span> <span class="st">"Queens"</span>,</span>
<span>                    borough_color <span class="op">=</span> <span class="va">BoroughColors</span><span class="op">[[</span><span class="st">"Queens"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                    top_color <span class="op">=</span> <span class="st">"purple"</span>,</span>
<span>                    col_prefix  <span class="op">=</span> <span class="st">"end_"</span><span class="op">)</span></span>
<span><span class="co">#&gt;                          end_zone end_long end_lat million_trips</span></span>
<span><span class="co">#&gt;                            &lt;char&gt;    &lt;num&gt;   &lt;num&gt;         &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:                    JFK Airport   -73.79   40.64         4.328</span></span>
<span><span class="co">#&gt; 2:              LaGuardia Airport   -73.87   40.78         4.196</span></span>
<span><span class="co">#&gt; 3:                  (Old) Astoria   -73.93   40.77         2.709</span></span>
<span><span class="co">#&gt; 4:             Elmhurst (Maspeth)   -73.88   40.74         1.771</span></span>
<span><span class="co">#&gt; 5: Long Island City/Hunters Point   -73.96   40.75         1.660</span></span></code></pre></div>
<div class="leaflet html-widget html-fill-item" id="htmlwidget-5b1b2f4ad92281566982" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-5b1b2f4ad92281566982">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addProviderTiles","args":["CartoDB",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[40.64459,40.77572,40.77205,40.74361,40.74829,40.7494,40.70179,40.72267,40.70074,40.74244,40.67544,40.77376,40.76358,40.74696,40.70055,40.69329,40.758916614532,40.69263,40.67302,40.74637,40.72729,40.745378,40.68094,40.73194,40.70141,40.71336,40.71481,40.71238,40.75306,40.70865,40.72696,40.77731,40.76439,40.76583,40.73064,40.66692,40.71795,40.60401,40.75647,40.68012,40.7841,40.588138,40.65483,40.65954,40.78863,40.74612,40.74292,40.7188,40.75566,40.69254,40.74162,40.75861,40.74905,40.5799,40.77978,40.72304,40.748,40.76863,40.766414,40.70344,40.56478,40.786790508562,40.60315,40.7763,40.61703],[-73.79436,-73.87452999999999,-73.92606000000001,-73.88433000000001,-73.9575,-73.88755999999999,-73.80853,-73.84791,-73.89509,-73.92074,-73.81113999999999,-73.90494,-73.83004,-73.90279,-73.82805999999999,-73.75644,-73.76222747739401,-73.86102,-73.78543000000001,-73.85483000000001,-73.89543999999999,-73.932194,-73.79089,-73.86884000000001,-73.88720000000001,-73.79886999999999,-73.75076,-73.8827,-73.86118999999999,-73.82890999999999,-73.79832,-73.78068,-73.87402,-73.80842,-73.82408,-73.75215,-73.78269,-73.75248999999999,-73.94729,-73.84735999999999,-73.84581,-73.81196300000001,-73.84602,-73.73994,-73.81373000000001,-73.85279,-73.82061,-73.76465,-73.81028000000001,-73.73184999999999,-73.78299,-73.78574,-73.75668,-73.83692000000001,-73.77867999999999,-73.71545999999999,-73.71324,-73.74733999999999,-73.896908,-73.85041,-73.89296,-73.792776615931,-73.8214,-73.92361,-73.82461000000001],[10,9.695140634466847,6.259392615124959,4.091697896433175,3.836743767102428,3.319637526741138,3.199314539553314,3.101962703594277,3.010535626889904,2.888176870238992,2.388294949489348,2.337881348608306,2.275255441697273,2.044839151104931,1.845675734506085,1.625475263205812,1.475080194528055,1.388503379007589,1.314480860300924,1.312449712334915,1.304914361348386,1.303151260212931,1.225979191247254,1.094111704357286,1.082622662620084,1.042545039955153,1.018582577603024,1.016123941157251,1.007077360626047,0.9828052579696562,0.973137086081391,0.8769452458890628,0.8737564129048836,0.8512266146470957,0.8006212216372948,0.7064975013876046,0.7037985470937486,0.6934741226203334,0.6932245617780932,0.6768066934066488,0.6702718965376208,0.6183678628487556,0.6178017294566367,0.615407793969963,0.5797806729916476,0.5293069926485846,0.513536133868133,0.4647192602277197,0.4253441051187239,0.4145529094403783,0.4038911156802313,0.3840787577046134,0.3358349497019365,0.3108511364954541,0.3060401580367141,0.2990824941850013,0.2846287620719281,0.2638435789612816,0.1142780690091187,0.07641183269625997,0.05912743362259284,0.03096865192316669,0.02313059287799571,0.01918614512147836,0.001109159298844949],null,null,{"interactive":true,"className":"","stroke":true,"color":["#A020F0","#A020F0","#A020F0","#A020F0","#A020F0","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8"],"weight":5,"opacity":0.5,"fill":true,"fillColor":["#A020F0","#A020F0","#A020F0","#A020F0","#A020F0","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8","#377EB8"],"fillOpacity":0.2},null,null,null,null,["JFK Airport","LaGuardia Airport","(Old) Astoria","Elmhurst (Maspeth)","Long Island City/Hunters Point","Jackson Heights","Jamaica","Forest Hills","Ridgewood","Sunnyside","South Ozone Park","Steinway","Flushing","Woodside","Richmond Hill","Saint Albans","Springfield Gardens (North|South)","Woodhaven","Baisley Park","Corona","Maspeth","Long Island City/Queens Plaza","South Jamaica","Rego Park","Glendale","Briarwood/Jamaica Hills","Queens Village","Middle Village","North Corona","Kew Gardens","Hillcrest/Pomonok","Bayside","East Elmhurst","Murray Hill-Queens","Kew Gardens Hills","Laurelton","Jamaica Estates","Far Rockaway","Queensbridge/Ravenswood","Ozone Park","College Point","Hammels/Arverne","Howard Beach","Rosedale","Whitestone","Flushing Meadows-Corona Park","Queensboro Hill","Hollis","East Flushing","Cambria Heights","Fresh Meadows","Auburndale","Oakland Gardens","Rockaway Park","Bay Terrace/Fort Totten","Bellerose","Glen Oaks","Douglaston","Saint Michaels Cemetery/Woodside","Forest Park/Highland Park","Breezy Point/Fort Tilden/Riis Beach","Willets Point","Broad Channel","Astoria Park","Jamaica Bay"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["#377EB8","#A020F0"],"labels":["Queens","TOP 5"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"topleft","type":"factor","title":null,"extra":null,"layerId":null,"className":"info legend","group":null}]}],"limits":{"lat":[40.56478,40.78863],"lng":[-73.9575,-73.71324]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="time-variables">Time variables<a class="anchor" aria-label="anchor" href="#time-variables"></a>
</h3>
<p>As we want to predict the <strong>profit rate</strong> related to
each trip, we just need to consider for this analysis
<code>request_datetime</code> as is the only variable available to the
driver before starting a trip and the <code>dropoff_datetime</code> the
point used to defining the end of a trip.</p>
<p>We know that a taxi trip takes more less than a day doesn’t make more
sense to explore each variable related to time. Instead, it is better to
consecrate the efforts to understand the distribution of the exploratory
variable later to explore the difference between
<code>request_datetime</code> and <code>dropoff_datetime</code> as a
<strong>numeric variable</strong>.</p>
<p>To describe this variable, we decomposed it in different parts and
count the number trips by each element and store the summary as a
<code>data.table</code> to explore each part using visualizations.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RequestTimeSummary</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">NycTrips2022</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>request_date <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html" class="external-link">as_date</a></span><span class="op">(</span><span class="va">request_datetime</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span>request_month <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/round_date.html" class="external-link">floor_date</a></span><span class="op">(</span><span class="va">request_date</span>, unit <span class="op">=</span> <span class="st">"month"</span><span class="op">)</span>,</span>
<span>        request_week <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/round_date.html" class="external-link">floor_date</a></span><span class="op">(</span><span class="va">request_date</span>, unit <span class="op">=</span> <span class="st">"week"</span><span class="op">)</span>,</span>
<span>        request_day <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html" class="external-link">day</a></span><span class="op">(</span><span class="va">request_date</span><span class="op">)</span>,</span>
<span>        request_weekday <span class="op">=</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/IDateTime.html" class="external-link">wday</a></span><span class="op">(</span><span class="va">request_date</span>, week_start <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>        request_hour <span class="op">=</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/IDateTime.html" class="external-link">hour</a></span><span class="op">(</span><span class="va">request_datetime</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="request_datetime-by-month">request_datetime by month<a class="anchor" aria-label="anchor" href="#request_datetime-by-month"></a>
</h4>
<p>In the next chart, we can see that the number trips keeps almost
constant must of the year, but we have some fewer trips during the first
2 months and some extra trips in October and December.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RequestTimeSummary</span><span class="op">[</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/IDateTime.html" class="external-link">year</a></span><span class="op">(</span><span class="va">request_month</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2022</span>, </span>
<span>                   <span class="fu">.</span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   by <span class="op">=</span> <span class="st">"request_month"</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">request_month</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey60"</span>,</span>
<span>            linewidth <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"dodgerblue4"</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_date</a></span><span class="op">(</span>date_labels <span class="op">=</span> <span class="st">"%y-%m"</span>,</span>
<span>               date_breaks <span class="op">=</span> <span class="st">"2 months"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/comma.html" class="external-link">comma_format</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                     breaks <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/breaks_width.html" class="external-link">breaks_width</a></span><span class="op">(</span><span class="fl">2e6</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Distribution of Trips by Month"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Trips Request Month"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Number of Trips"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html" class="external-link">expand_limits</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>        panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code></pre></div>
<p><img src="03-data-understanding_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="request_datetime-by-week">request_datetime by week<a class="anchor" aria-label="anchor" href="#request_datetime-by-week"></a>
</h4>
<p>By breaking the months into weeks we can confirm we have fewer trips
in the first 2 months, in relation to October we don’t see a big change
in he number of trips we see is that it has more weeks than November,
but December keeps having more trips than normal in the first 2
weeks.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RequestTimeSummary</span><span class="op">[</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/IDateTime.html" class="external-link">year</a></span><span class="op">(</span><span class="va">request_month</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2022</span>, </span>
<span>                   <span class="fu">.</span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   by <span class="op">=</span> <span class="st">"request_week"</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">request_week</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey60"</span>,</span>
<span>            linewidth <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"dodgerblue4"</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_date</a></span><span class="op">(</span>date_labels <span class="op">=</span> <span class="st">"%y-%m"</span>,</span>
<span>               date_breaks <span class="op">=</span> <span class="st">"month"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/comma.html" class="external-link">comma_format</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                     breaks <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/breaks_width.html" class="external-link">breaks_width</a></span><span class="op">(</span><span class="fl">5e5</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Distribution of Trips by Week"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Trips Request Week"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Number of Trips"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html" class="external-link">expand_limits</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>        panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code></pre></div>
<p><img src="03-data-understanding_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="request_datetime-by-month-day">request_datetime by month day<a class="anchor" aria-label="anchor" href="#request_datetime-by-month-day"></a>
</h4>
<p>If we explore the number of trips by month day we can not see any
consistent pattern after plotting a line with total of trips for each
month.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RequestTimeSummary</span><span class="op">[</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/IDateTime.html" class="external-link">year</a></span><span class="op">(</span><span class="va">request_month</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2022</span>, </span>
<span>                   <span class="fu">.</span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   by <span class="op">=</span> <span class="fu">.</span><span class="op">(</span>request_month <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">request_month</span>, <span class="st">"%B"</span><span class="op">)</span>,</span>
<span>                          <span class="va">request_day</span><span class="op">)</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">request_day</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">request_month</span><span class="op">)</span>,</span>
<span>            color <span class="op">=</span> <span class="st">"gray60"</span>,</span>
<span>            linewidth <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">'loess'</span>,</span>
<span>              formula <span class="op">=</span> <span class="st">'y ~ x'</span>,</span>
<span>              se <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>              linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/breaks_width.html" class="external-link">breaks_width</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/comma.html" class="external-link">comma_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html" class="external-link">expand_limits</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Number of Trips by Month Day"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Number of Trips"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Day of Month"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="03-data-understanding_files/figure-html/unnamed-chunk-30-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="request_datetime-by-week-day">request_datetime by week day<a class="anchor" aria-label="anchor" href="#request_datetime-by-week-day"></a>
</h4>
<p>By if we change the month day in the prior chart with week day we can
find that the number of trips trends to be higher Fridays and
Saturdays.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RequestTimeSummary</span><span class="op">[</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/IDateTime.html" class="external-link">year</a></span><span class="op">(</span><span class="va">request_month</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2022</span>, </span>
<span>                   <span class="fu">.</span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   by <span class="op">=</span> <span class="fu">.</span><span class="op">(</span>request_month <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">request_month</span>, <span class="st">"%B"</span><span class="op">)</span>,</span>
<span>                          <span class="va">request_weekday</span><span class="op">)</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">request_weekday</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">request_month</span><span class="op">)</span>,</span>
<span>            color <span class="op">=</span> <span class="st">"gray60"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">'loess'</span>,</span>
<span>              formula <span class="op">=</span> <span class="st">'y ~ x'</span>,</span>
<span>              se <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>              linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/breaks_width.html" class="external-link">breaks_width</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>                     labels <span class="op">=</span> <span class="va">factor_weekday</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/comma.html" class="external-link">comma_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html" class="external-link">expand_limits</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Number of Trips by Week Day"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Number of Trips"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Day of Week"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="03-data-understanding_files/figure-html/unnamed-chunk-31-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="request_datetime-by-week-day-and-hour">request_datetime by week day and hour<a class="anchor" aria-label="anchor" href="#request_datetime-by-week-day-and-hour"></a>
</h4>
<p>To understand better what is happening Fridays and Saturdays let’s
break each week day by hour. In the next chart, we can see how the
higher number of trips start at 17:00 and end at 1:00 of next day for
Fridays and Saturdays.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RequestTimeSummary</span><span class="op">[</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/IDateTime.html" class="external-link">year</a></span><span class="op">(</span><span class="va">request_month</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2022</span>, </span>
<span>                   <span class="fu">.</span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   by <span class="op">=</span> <span class="fu">.</span><span class="op">(</span>request_hour <span class="op">=</span> </span>
<span>                            <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">request_hour</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html" class="external-link">fct_rev</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>                          request_weekday <span class="op">=</span> <span class="fu"><a href="../reference/factor_weekday.html">factor_weekday</a></span><span class="op">(</span><span class="va">request_weekday</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">]</span><span class="op">[</span>, <span class="va">n_million</span> <span class="op">:=</span> <span class="va">n</span><span class="op">/</span><span class="fl">1e6</span> <span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">request_weekday</span>, <span class="va">request_hour</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">n</span><span class="op">)</span>,</span>
<span>            color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>            linewidth <span class="op">=</span> <span class="fl">0.005</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/comma.html" class="external-link">comma</a></span><span class="op">(</span><span class="va">n_million</span>, accuracy <span class="op">=</span> <span class="fl">0.1</span>, suffix <span class="op">=</span> <span class="st">" M"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"white"</span>, </span>
<span>                      high <span class="op">=</span> <span class="st">"dodgerblue4"</span>,</span>
<span>                      labels<span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/comma.html" class="external-link">comma_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Number of Trips by Hour and Week Day"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Number of Trips"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Request Week Day"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Request Hour"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.line <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="03-data-understanding_files/figure-html/unnamed-chunk-32-1.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="numeric-variables">Numeric variables<a class="anchor" aria-label="anchor" href="#numeric-variables"></a>
</h3>
<p>Last but not least, it time check explore the individual distribution
of numeric variable based of summary metrics by using the custom
<code>compute_num_summary</code> to use all the power under the
<code>arrow</code> package.</p>
<div class="section level4">
<h4 id="trip_miles">trip_miles<a class="anchor" aria-label="anchor" href="#trip_miles"></a>
</h4>
<p>Below we can see that the min distance was <strong>0 miles</strong>
which can be possible if the trip duration was also short, but we need
to check those cases and the higher distance was <strong>634
miles</strong>, which can be a valid outlier taking in consideration
that the higher whisker is 13.2 miles.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NycTrips2022</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/compute_num_summary.html">compute_num_summary</a></span><span class="op">(</span><span class="va">trip_miles</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: quantile() currently returns an approximate quantile in Arrow</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once per session.</span></span></span>
<span><span class="co">#&gt; Warning: median() currently returns an approximate median in Arrow</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once per session.</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 9</span></span></span>
<span><span class="co">#&gt;      sd min_value lower_whisker    q1    q2  mean    q3 higher_whisker max_value</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  5.87         0         -<span style="color: #BB0000;">5.34</span>  1.62  3.03  5.03  6.26           13.2      634.</span></span></code></pre></div>
<p>We can also check that only 24.4K trips are over 100 miles.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NycTrips2022</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/count_pct.html">count_pct</a></span><span class="op">(</span>trip_miles_status <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">trip_miles</span> <span class="op">&lt;</span> <span class="fl">100</span> <span class="op">~</span> <span class="st">"Normal trips"</span>,</span>
<span>                                          <span class="va">trip_miles</span> <span class="op">&gt;=</span> <span class="fl">100</span> <span class="op">~</span> <span class="st">"Long Trips"</span><span class="op">)</span>,</span>
<span>            digits <span class="op">=</span> <span class="fl">4L</span><span class="op">)</span></span>
<span><span class="co">#&gt;    trip_miles_status         n    pct pct_cumulative</span></span>
<span><span class="co">#&gt;               &lt;char&gt;     &lt;int&gt;  &lt;num&gt;          &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:      Normal trips 212391618 0.9999         0.9999</span></span>
<span><span class="co">#&gt; 2:        Long Trips     24465 0.0001         1.0000</span></span></code></pre></div>
<p>But even just taking the long trips we can see that 98% of those
trips were shorter than <strong>300 miles</strong>, those trips doesn’t
look like good examples to train the model.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NycTrips2022</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">trip_miles</span> <span class="op">&gt;=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/count_pct.html">count_pct</a></span><span class="op">(</span>miles_interval <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">trip_miles</span> <span class="op">&gt;=</span> <span class="fl">600</span> <span class="op">~</span> <span class="st">"&gt;=600"</span>,</span>
<span>                                       <span class="va">trip_miles</span> <span class="op">&gt;=</span> <span class="fl">500</span> <span class="op">~</span> <span class="st">"[500, 600)"</span>,</span>
<span>                                       <span class="va">trip_miles</span> <span class="op">&gt;=</span> <span class="fl">400</span> <span class="op">~</span> <span class="st">"[400, 500)"</span>,</span>
<span>                                       <span class="va">trip_miles</span> <span class="op">&gt;=</span> <span class="fl">300</span> <span class="op">~</span> <span class="st">"[300, 400)"</span>,</span>
<span>                                       <span class="va">trip_miles</span> <span class="op">&gt;=</span> <span class="fl">200</span> <span class="op">~</span> <span class="st">"[200, 300)"</span>,</span>
<span>                                       <span class="va">trip_miles</span> <span class="op">&gt;=</span> <span class="fl">150</span> <span class="op">~</span> <span class="st">"[150, 200)"</span>,</span>
<span>                                       <span class="va">trip_miles</span> <span class="op">&gt;=</span> <span class="fl">130</span> <span class="op">~</span> <span class="st">"[130, 150)"</span>,</span>
<span>                                       <span class="va">trip_miles</span> <span class="op">&gt;=</span> <span class="fl">115</span> <span class="op">~</span> <span class="st">"[115, 130)"</span>,</span>
<span>                                       <span class="va">trip_miles</span> <span class="op">&gt;=</span> <span class="fl">100</span> <span class="op">~</span> <span class="st">"[100,115)"</span><span class="op">)</span>,</span>
<span>            digits <span class="op">=</span> <span class="fl">4L</span><span class="op">)</span></span>
<span><span class="co">#&gt;    miles_interval     n    pct pct_cumulative</span></span>
<span><span class="co">#&gt;            &lt;char&gt; &lt;int&gt;  &lt;num&gt;          &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:      [100,115) 11735 0.4797         0.4797</span></span>
<span><span class="co">#&gt; 2:     [115, 130)  5292 0.2163         0.6960</span></span>
<span><span class="co">#&gt; 3:     [130, 150)  2802 0.1145         0.8105</span></span>
<span><span class="co">#&gt; 4:     [150, 200)  2370 0.0969         0.9074</span></span>
<span><span class="co">#&gt; 5:     [200, 300)  1675 0.0685         0.9759</span></span>
<span><span class="co">#&gt; 6:     [300, 400)   248 0.0101         0.9860</span></span>
<span><span class="co">#&gt; 7:     [400, 500)   233 0.0095         0.9955</span></span>
<span><span class="co">#&gt; 8:     [500, 600)    95 0.0039         0.9994</span></span>
<span><span class="co">#&gt; 9:          &gt;=600    15 0.0006         1.0000</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="base_passenger_fare">base_passenger_fare<a class="anchor" aria-label="anchor" href="#base_passenger_fare"></a>
</h4>
<p>Just by checking the summary statistics we can see to important
problems:</p>
<ul>
<li>A base fare can not be negative</li>
<li>A base of almost $5k is too much</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NycTrips2022</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/compute_num_summary.html">compute_num_summary</a></span><span class="op">(</span><span class="va">base_passenger_fare</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 9</span></span></span>
<span><span class="co">#&gt;      sd min_value lower_whisker    q1    q2  mean    q3 higher_whisker max_value</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  19.7     -<span style="color: #BB0000;">520.</span>         -<span style="color: #BB0000;">15.1</span>  11.4  18.2  23.7  29.1           55.6     <span style="text-decoration: underline;">4</span>996.</span></span></code></pre></div>
<p>By checking the closer to the distribution we can confirm that 99% of
trips present a base fare from 5 to 50 dollars, but any fare higher that
750 dollars seems weird won’t be used to train the model.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NycTrips2022</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/count_pct.html">count_pct</a></span><span class="op">(</span>base_passenger_fare_interval <span class="op">=</span> </span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">base_passenger_fare</span> <span class="op">&gt;=</span> <span class="fl">4000</span> <span class="op">~</span> <span class="st">"&gt;=4000"</span>,</span>
<span>                        <span class="va">base_passenger_fare</span> <span class="op">&gt;=</span> <span class="fl">3000</span> <span class="op">~</span> <span class="st">"[3000, 4000)"</span>,</span>
<span>                        <span class="va">base_passenger_fare</span> <span class="op">&gt;=</span> <span class="fl">2000</span> <span class="op">~</span> <span class="st">"[2000, 3000)"</span>,</span>
<span>                        <span class="va">base_passenger_fare</span> <span class="op">&gt;=</span> <span class="fl">1000</span> <span class="op">~</span> <span class="st">"[1000, 2000)"</span>,</span>
<span>                        <span class="va">base_passenger_fare</span> <span class="op">&gt;=</span> <span class="fl">750</span> <span class="op">~</span> <span class="st">"[750, 1000)"</span>,</span>
<span>                        <span class="va">base_passenger_fare</span> <span class="op">&gt;=</span> <span class="fl">500</span> <span class="op">~</span> <span class="st">"[500, 750)"</span>,</span>
<span>                        <span class="va">base_passenger_fare</span> <span class="op">&gt;=</span> <span class="fl">400</span> <span class="op">~</span> <span class="st">"[400, 500)"</span>,</span>
<span>                        <span class="va">base_passenger_fare</span> <span class="op">&gt;=</span> <span class="fl">300</span> <span class="op">~</span> <span class="st">"[300, 400)"</span>,</span>
<span>                        <span class="va">base_passenger_fare</span> <span class="op">&gt;=</span> <span class="fl">200</span> <span class="op">~</span> <span class="st">"[200, 300)"</span>,</span>
<span>                        <span class="va">base_passenger_fare</span> <span class="op">&gt;=</span> <span class="fl">100</span> <span class="op">~</span> <span class="st">"[100, 200)"</span>,</span>
<span>                        <span class="va">base_passenger_fare</span> <span class="op">&gt;=</span> <span class="fl">50</span> <span class="op">~</span> <span class="st">"[50, 10)"</span>,</span>
<span>                        <span class="va">base_passenger_fare</span> <span class="op">&gt;=</span> <span class="fl">5</span> <span class="op">~</span> <span class="st">"[5, 50)"</span>,</span>
<span>                        <span class="va">base_passenger_fare</span> <span class="op">&gt;=</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"[0, 5)"</span>,</span>
<span>                        <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"&lt;0"</span><span class="op">)</span>,</span>
<span>            digits <span class="op">=</span> <span class="fl">8L</span><span class="op">)</span></span>
<span><span class="co">#&gt;     base_passenger_fare_interval         n       pct pct_cumulative</span></span>
<span><span class="co">#&gt;                           &lt;char&gt;     &lt;int&gt;     &lt;num&gt;          &lt;num&gt;</span></span>
<span><span class="co">#&gt;  1:                      [5, 50) 196074667 9.231e-01         0.9231</span></span>
<span><span class="co">#&gt;  2:                     [50, 10)  13910864 6.549e-02         0.9886</span></span>
<span><span class="co">#&gt;  3:                   [100, 200)   1866578 8.787e-03         0.9973</span></span>
<span><span class="co">#&gt;  4:                           &lt;0    233608 1.100e-03         0.9984</span></span>
<span><span class="co">#&gt;  5:                       [0, 5)    175426 8.259e-04         0.9993</span></span>
<span><span class="co">#&gt;  6:                   [200, 300)    123817 5.829e-04         0.9999</span></span>
<span><span class="co">#&gt;  7:                   [300, 400)     21832 1.028e-04         1.0000</span></span>
<span><span class="co">#&gt;  8:                   [400, 500)      5225 2.460e-05         1.0000</span></span>
<span><span class="co">#&gt;  9:                   [500, 750)      3290 1.549e-05         1.0000</span></span>
<span><span class="co">#&gt; 10:                  [750, 1000)       482 2.270e-06         1.0000</span></span>
<span><span class="co">#&gt; 11:                 [1000, 2000)       241 1.130e-06         1.0000</span></span>
<span><span class="co">#&gt; 12:                 [2000, 3000)        49 2.300e-07         1.0000</span></span>
<span><span class="co">#&gt; 13:                 [3000, 4000)         3 1.000e-08         1.0000</span></span>
<span><span class="co">#&gt; 14:                       &gt;=4000         1 0.000e+00         1.0000</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="driver_pay">driver_pay<a class="anchor" aria-label="anchor" href="#driver_pay"></a>
</h4>
<p>Just by checking the summary statistics we can confirm that also
<code>driver_pay</code> is sharing the same problems that
<code>base_passenger_fare</code>.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NycTrips2022</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/compute_num_summary.html">compute_num_summary</a></span><span class="op">(</span><span class="va">driver_pay</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 9</span></span></span>
<span><span class="co">#&gt;      sd min_value lower_whisker    q1    q2  mean    q3 higher_whisker max_value</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  15.4     -<span style="color: #BB0000;">407.</span>         -<span style="color: #BB0000;">12.9</span>  8.86  14.3  18.7  23.3           45.1     <span style="text-decoration: underline;">4</span>643.</span></span></code></pre></div>
<p>And after checking the distribution we can confirm that paying more
than 750 must be a mistake that we don’t want to use for training the
model.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NycTrips2022</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/count_pct.html">count_pct</a></span><span class="op">(</span>driver_pay_interval <span class="op">=</span> </span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">driver_pay</span> <span class="op">&gt;=</span> <span class="fl">4000</span> <span class="op">~</span> <span class="st">"&gt;=4000"</span>,</span>
<span>                        <span class="va">driver_pay</span> <span class="op">&gt;=</span> <span class="fl">3000</span> <span class="op">~</span> <span class="st">"[3000, 4000)"</span>,</span>
<span>                        <span class="va">driver_pay</span> <span class="op">&gt;=</span> <span class="fl">2000</span> <span class="op">~</span> <span class="st">"[2000, 3000)"</span>,</span>
<span>                        <span class="va">driver_pay</span> <span class="op">&gt;=</span> <span class="fl">1000</span> <span class="op">~</span> <span class="st">"[1000, 2000)"</span>,</span>
<span>                        <span class="va">driver_pay</span> <span class="op">&gt;=</span> <span class="fl">750</span> <span class="op">~</span> <span class="st">"[750, 1000)"</span>,</span>
<span>                        <span class="va">driver_pay</span> <span class="op">&gt;=</span> <span class="fl">500</span> <span class="op">~</span> <span class="st">"[500, 750)"</span>,</span>
<span>                        <span class="va">driver_pay</span> <span class="op">&gt;=</span> <span class="fl">400</span> <span class="op">~</span> <span class="st">"[400, 500)"</span>,</span>
<span>                        <span class="va">driver_pay</span> <span class="op">&gt;=</span> <span class="fl">300</span> <span class="op">~</span> <span class="st">"[300, 400)"</span>,</span>
<span>                        <span class="va">driver_pay</span> <span class="op">&gt;=</span> <span class="fl">200</span> <span class="op">~</span> <span class="st">"[200, 300)"</span>,</span>
<span>                        <span class="va">driver_pay</span> <span class="op">&gt;=</span> <span class="fl">100</span> <span class="op">~</span> <span class="st">"[100, 200)"</span>,</span>
<span>                        <span class="va">driver_pay</span> <span class="op">&gt;=</span> <span class="fl">50</span> <span class="op">~</span> <span class="st">"[50, 10)"</span>,</span>
<span>                        <span class="va">driver_pay</span> <span class="op">&gt;=</span> <span class="fl">5</span> <span class="op">~</span> <span class="st">"[5, 50)"</span>,</span>
<span>                        <span class="va">driver_pay</span> <span class="op">&gt;=</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"[0, 5)"</span>,</span>
<span>                        <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"&lt;0"</span><span class="op">)</span>,</span>
<span>            digits <span class="op">=</span> <span class="fl">8L</span><span class="op">)</span></span>
<span><span class="co">#&gt;     driver_pay_interval         n       pct pct_cumulative</span></span>
<span><span class="co">#&gt;                  &lt;char&gt;     &lt;int&gt;     &lt;num&gt;          &lt;num&gt;</span></span>
<span><span class="co">#&gt;  1:             [5, 50) 202732167 9.544e-01         0.9544</span></span>
<span><span class="co">#&gt;  2:            [50, 10)   7570284 3.564e-02         0.9900</span></span>
<span><span class="co">#&gt;  3:              [0, 5)   1371619 6.457e-03         0.9965</span></span>
<span><span class="co">#&gt;  4:          [100, 200)    688052 3.239e-03         0.9997</span></span>
<span><span class="co">#&gt;  5:          [200, 300)     40563 1.910e-04         0.9999</span></span>
<span><span class="co">#&gt;  6:          [300, 400)      6864 3.231e-05         1.0000</span></span>
<span><span class="co">#&gt;  7:                  &lt;0      2678 1.261e-05         1.0000</span></span>
<span><span class="co">#&gt;  8:          [400, 500)      2164 1.019e-05         1.0000</span></span>
<span><span class="co">#&gt;  9:          [500, 750)      1201 5.650e-06         1.0000</span></span>
<span><span class="co">#&gt; 10:         [750, 1000)       327 1.540e-06         1.0000</span></span>
<span><span class="co">#&gt; 11:        [1000, 2000)       160 7.500e-07         1.0000</span></span>
<span><span class="co">#&gt; 12:        [2000, 3000)         3 1.000e-08         1.0000</span></span>
<span><span class="co">#&gt; 13:              &gt;=4000         1 0.000e+00         1.0000</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="tips">tips<a class="anchor" aria-label="anchor" href="#tips"></a>
</h4>
<p>The column looks really good, it makes sense that for more than 75%
of trips the tip is 0 as it is not mandatory, but having a trip with a
$294 tip is not hard to believe.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NycTrips2022</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/compute_num_summary.html">compute_num_summary</a></span><span class="op">(</span><span class="va">tips</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 9</span></span></span>
<span><span class="co">#&gt;      sd min_value lower_whisker    q1    q2  mean         q3 higher_whisker</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  3.04         0   -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">008</span><span style="color: #BB0000;">92</span>     0     0  1.08 0.000<span style="text-decoration: underline;">005</span>95      0.000<span style="text-decoration: underline;">014</span>9</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: max_value &lt;dbl&gt;</span></span></span></code></pre></div>
<p>After braking the <code>tips</code> we can see that <code>80%</code>
of trips don’t present any tip and must of the tips are lower than
<strong>50 dollars</strong>, so gets really hard to achieved more than
that based on tips.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NycTrips2022</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/count_pct.html">count_pct</a></span><span class="op">(</span>tips_interval <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">tips</span> <span class="op">&gt;=</span> <span class="fl">250</span> <span class="op">~</span> <span class="st">"&gt;=250"</span>,</span>
<span>                                      <span class="va">tips</span> <span class="op">&gt;=</span> <span class="fl">200</span> <span class="op">~</span> <span class="st">"[200, 250)"</span>,</span>
<span>                                      <span class="va">tips</span> <span class="op">&gt;=</span> <span class="fl">150</span> <span class="op">~</span> <span class="st">"[150, 200)"</span>,</span>
<span>                                      <span class="va">tips</span> <span class="op">&gt;=</span> <span class="fl">100</span> <span class="op">~</span> <span class="st">"[100, 150)"</span>,</span>
<span>                                      <span class="va">tips</span> <span class="op">&gt;=</span> <span class="fl">50</span> <span class="op">~</span> <span class="st">"[50, 100)"</span>,</span>
<span>                                      <span class="va">tips</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"(0, 50)"</span>,</span>
<span>                                      <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"0"</span><span class="op">)</span>,</span>
<span>            digits <span class="op">=</span> <span class="fl">8L</span><span class="op">)</span></span>
<span><span class="co">#&gt;    tips_interval         n       pct pct_cumulative</span></span>
<span><span class="co">#&gt;           &lt;char&gt;     &lt;int&gt;     &lt;num&gt;          &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:             0 170057940 8.006e-01         0.8006</span></span>
<span><span class="co">#&gt; 2:       (0, 50)  42325635 1.993e-01         0.9998</span></span>
<span><span class="co">#&gt; 3:     [50, 100)     31872 1.500e-04         1.0000</span></span>
<span><span class="co">#&gt; 4:    [100, 150)       572 2.690e-06         1.0000</span></span>
<span><span class="co">#&gt; 5:    [150, 200)        56 2.600e-07         1.0000</span></span>
<span><span class="co">#&gt; 6:    [200, 250)         7 3.000e-08         1.0000</span></span>
<span><span class="co">#&gt; 7:         &gt;=250         1 0.000e+00         1.0000</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="trip_minutes">trip_minutes<a class="anchor" aria-label="anchor" href="#trip_minutes"></a>
</h4>
<p>After taking the difference in minutes between the request time and
the drop off time in minutes, we can see negative trips and some other
much longer than an hour.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NycTrips2022</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>trip_minutes <span class="op">=</span> <span class="fu">arrow_minutes_between</span><span class="op">(</span><span class="va">request_datetime</span>, <span class="va">dropoff_datetime</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/compute_num_summary.html">compute_num_summary</a></span><span class="op">(</span><span class="va">trip_minutes</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 9</span></span></span>
<span><span class="co">#&gt;      sd min_value lower_whisker    q1    q2  mean    q3 higher_whisker max_value</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  14.7      -<span style="color: #BB0000;">314</span>         -<span style="color: #BB0000;">8.99</span>  14.7  20.9  24.6  30.5           54.3      <span style="text-decoration: underline;">2</span>469</span></span></code></pre></div>
<p>Now we can see that 99% of trips takes less than 2 hours and only
152,049 trips have more than 2 hour trip.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NycTrips2022</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>trip_minutes <span class="op">=</span> <span class="fu">arrow_minutes_between</span><span class="op">(</span><span class="va">request_datetime</span>, <span class="va">dropoff_datetime</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/count_pct.html">count_pct</a></span><span class="op">(</span>trip_minutes_status <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">trip_minutes</span> <span class="op">&lt;</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"Negative"</span>,</span>
<span>                                            <span class="va">trip_minutes</span> <span class="op">&lt;=</span> <span class="fl">60</span>   <span class="op">~</span> <span class="st">"1 hour or less"</span>,</span>
<span>                                            <span class="va">trip_minutes</span> <span class="op">&lt;=</span> <span class="op">(</span><span class="fl">60</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span> <span class="op">~</span> <span class="st">"(1:00, 2:00]"</span>,</span>
<span>                                            <span class="va">trip_minutes</span> <span class="op">&lt;=</span> <span class="op">(</span><span class="fl">60</span><span class="op">*</span><span class="fl">3</span><span class="op">)</span> <span class="op">~</span> <span class="st">"(2:00, 3:00]"</span>,</span>
<span>                                            <span class="va">trip_minutes</span> <span class="op">&gt;</span> <span class="op">(</span><span class="fl">60</span><span class="op">*</span><span class="fl">3</span><span class="op">)</span> <span class="op">~</span> <span class="st">"&gt;3 hours"</span><span class="op">)</span>,</span>
<span>            digits <span class="op">=</span> <span class="fl">6L</span><span class="op">)</span></span>
<span><span class="co">#&gt;    trip_minutes_status         n      pct pct_cumulative</span></span>
<span><span class="co">#&gt;                 &lt;char&gt;     &lt;int&gt;    &lt;num&gt;          &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:      1 hour or less 206298571 0.971200         0.9712</span></span>
<span><span class="co">#&gt; 2:        (1:00, 2:00]   5740869 0.027027         0.9982</span></span>
<span><span class="co">#&gt; 3:            Negative    224594 0.001057         0.9993</span></span>
<span><span class="co">#&gt; 4:        (2:00, 3:00]    132341 0.000623         0.9999</span></span>
<span><span class="co">#&gt; 5:            &gt;3 hours     19708 0.000093         1.0000</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="sampling-data">Sampling data<a class="anchor" aria-label="anchor" href="#sampling-data"></a>
</h2>
<p>Due our limited compute power capacity we will need to sample the
data to be able to unlock all R capacities.</p>
<p>As most of the trips take place between Manhattan, Brooklyn and
Queens, we are going to focus first in those zones.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">BoroughToKeep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Manhattan"</span>, <span class="st">"Brooklyn"</span>, <span class="st">"Queens"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">TrainingTrips</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="va">data_path</span>,</span>
<span>      full.names <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">sample_parquet</span>,</span>
<span>         valid_zones <span class="op">=</span> <span class="va">ZoneCodesArcgisClean</span><span class="op">[</span><span class="va">Borough</span> <span class="op"><a href="https://rdatatable.gitlab.io/data.table/reference/chmatch.html" class="external-link">%chin%</a></span> <span class="va">BoroughToKeep</span>, <span class="va">LocationID</span><span class="op">]</span>,</span>
<span>         prob <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/rbindlist.html" class="external-link">rbindlist</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="solving-quality-problems">Solving quality problems<a class="anchor" aria-label="anchor" href="#solving-quality-problems"></a>
</h2>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TrainingTripsCleaned</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">TrainingTrips</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_zone_description.html">add_zone_description</a></span><span class="op">(</span>zone_dt <span class="op">=</span> <span class="va">ZoneCodesArcgisClean</span>,</span>
<span>                       start_id_col <span class="op">=</span> <span class="st">"PULocationID"</span>,</span>
<span>                       end_id_col <span class="op">=</span> <span class="st">"DOLocationID"</span>,</span>
<span>                       zone_id_col <span class="op">=</span> <span class="st">"LocationID"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/apply_base_cleaning.html">apply_base_cleaning</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">TrainingTripsCleaned</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 1,702,465</span></span>
<span><span class="co">#&gt; Columns: 23</span></span>
<span><span class="co">#&gt; $ company              <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> Lyft, Uber, Uber, Uber, Uber, Uber, Uber, Uber, U…</span></span>
<span><span class="co">#&gt; $ dispatching_base_num <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> B03406, B03404, B03404, B03404, B03404, B03404, B…</span></span>
<span><span class="co">#&gt; $ originating_base_num <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> Other, B03404, B03404, B03404, B03404, B03404, B0…</span></span>
<span><span class="co">#&gt; $ shared_request_flag  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N…</span></span>
<span><span class="co">#&gt; $ shared_match_flag    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N…</span></span>
<span><span class="co">#&gt; $ access_a_ride_flag   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> N, Missing, Missing, Missing, Missing, Missing, M…</span></span>
<span><span class="co">#&gt; $ wav_request_flag     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N…</span></span>
<span><span class="co">#&gt; $ wav_match_flag       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N…</span></span>
<span><span class="co">#&gt; $ start_borough        <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> Queens, Manhattan, Brooklyn, Brooklyn, Queens, Ma…</span></span>
<span><span class="co">#&gt; $ end_borough          <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> Manhattan, Manhattan, Brooklyn, Brooklyn, Brookly…</span></span>
<span><span class="co">#&gt; $ start_service_zone   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> Boro Zone, Yellow Zone, Boro Zone, Boro Zone, Air…</span></span>
<span><span class="co">#&gt; $ end_service_zone     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> Yellow Zone, Yellow Zone, Boro Zone, Boro Zone, B…</span></span>
<span><span class="co">#&gt; $ same_borough         <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> FALSE, TRUE, TRUE, TRUE, FALSE, TRUE, TRUE, TRUE,…</span></span>
<span><span class="co">#&gt; $ same_service_zone    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> FALSE, TRUE, TRUE, TRUE, FALSE, TRUE, TRUE, TRUE,…</span></span>
<span><span class="co">#&gt; $ same_zone            <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> FALSE, TRUE, FALSE, FALSE, FALSE, FALSE, FALSE, F…</span></span>
<span><span class="co">#&gt; $ base_passenger_fare  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 36.95, 14.15, 29.70, 9.53, 21.30, 10.98, 9.67, 10…</span></span>
<span><span class="co">#&gt; $ trip_miles           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 23.749, 0.640, 9.250, 1.570, 6.720, 1.700, 1.510,…</span></span>
<span><span class="co">#&gt; $ request_datetime     <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span> 2022-01-02 14:34:02, 2022-01-18 21:05:37, 2022-0…</span></span>
<span><span class="co">#&gt; $ dropoff_datetime     <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span> 2022-01-02 15:23:01, 2022-01-18 21:15:34, 2022-0…</span></span>
<span><span class="co">#&gt; $ trip_minutes         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 48, 9, 38, 12, 27, 14, 16, 11, 23, 14, 7, 15, 18,…</span></span>
<span><span class="co">#&gt; $ tips                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 7, 0, 1, 0, 0, 0, 0, 0, 0, 0…</span></span>
<span><span class="co">#&gt; $ driver_pay           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 58.64, 11.11, 28.22, 7.71, 17.44, 7.64, 6.70, 8.4…</span></span>
<span><span class="co">#&gt; $ profit_rate          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 73.30, 74.07, 44.56, 38.55, 38.76, 32.74, 25.12, …</span></span></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TrainingTripsCleaned</span><span class="op">[</span>, <span class="va">.N</span>,</span>
<span>                     by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"trip_minutes"</span>,</span>
<span>                            <span class="st">"profit_rate"</span><span class="op">)</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">trip_minutes</span>, <span class="va">profit_rate</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="va">N</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/dollar_format.html" class="external-link">dollar_format</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                     trans <span class="op">=</span> <span class="st">"log2"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in transformation$transform(x): NaNs produced</span></span>
<span><span class="co">#&gt; Warning in scale_y_continuous(labels = dollar_format(), trans = "log2"):</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">log-2</span> transformation introduced infinite values.</span></span>
<span><span class="co">#&gt; Warning: Removed 15 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<p><img src="03-data-understanding_files/figure-html/unnamed-chunk-49-1.png" width="700"></p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TrainingTripsCleaned</span><span class="op">[</span>, <span class="va">.SD</span>, .SDcols <span class="op">=</span> <span class="fu">patterns</span><span class="op">(</span><span class="st">"profit_rate|company|_num|_flag"</span><span class="op">)</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/melt.data.table.html" class="external-link">melt</a></span><span class="op">(</span>id.vars <span class="op">=</span> <span class="st">"profit_rate"</span>,</span>
<span>       value.factor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">value</span>, <span class="va">profit_rate</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">variable</span><span class="op">)</span></span></code></pre></div>
<p><img src="03-data-understanding_files/figure-html/unnamed-chunk-50-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="correlations-between-predictors-and-target-variable">Correlations between predictors and target variable<a class="anchor" aria-label="anchor" href="#correlations-between-predictors-and-target-variable"></a>
</h2>
<p>Before exploring correlations we need to transforming the sampled
data by:</p>
<ul>
<li>Solving quality problems.</li>
<li>Transforming categorical variables into boolean ones.</li>
<li>Transforming zone code to factors.</li>
<li>Adding new features.</li>
</ul>
</div>
<div class="section level2">
<h2 id="start_service-vs-end_service-zones">start_service vs end_service zones<a class="anchor" aria-label="anchor" href="#start_service-vs-end_service-zones"></a>
</h2>
<ul>
<li>
<p><code>start_zone</code> and <code>end_zone</code>: As our data
has 46,521 rows of relations between both columns, we opted to transform
data in a way what each unique zone represent a row reducing the points
to be plotted to only 218 by following the next steps:</p>
<ol style="list-style-type: decimal">
<li>Summarizing the total number of trips for each <strong>starting
point</strong> independently to its destination</li>
<li>Summarizing the total number of trips for each <strong>ending
point</strong> independently to its origin.</li>
<li>Joining both tables into one.</li>
</ol>
</li>
</ul>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Summarizing Staring Zones</span></span>
<span><span class="va">StartingZonesCount</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">TripsZoneDistribution</span><span class="op">[</span></span>
<span>    <span class="op">!</span><span class="va">start_borough</span> <span class="op"><a href="https://rdatatable.gitlab.io/data.table/reference/chmatch.html" class="external-link">%chin%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Staten Island"</span>, <span class="st">"Unknown"</span>, <span class="st">"EWR"</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>      <span class="op">!</span><span class="va">end_borough</span> <span class="op"><a href="https://rdatatable.gitlab.io/data.table/reference/chmatch.html" class="external-link">%chin%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Staten Island"</span>, <span class="st">"Unknown"</span>, <span class="st">"EWR"</span><span class="op">)</span>,</span>
<span>    <span class="fu">.</span><span class="op">(</span>start_trips <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    by <span class="op">=</span>  <span class="fu">.</span><span class="op">(</span>borough <span class="op">=</span> <span class="va">start_borough</span>, </span>
<span>            zone <span class="op">=</span> <span class="va">start_zone</span><span class="op">)</span></span>
<span>  <span class="op">]</span></span>
<span></span>
<span><span class="co"># 2. Summarizing Ending Zones</span></span>
<span><span class="va">EndingZonesCount</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">TripsZoneDistribution</span><span class="op">[</span></span>
<span>    <span class="op">!</span><span class="va">start_borough</span> <span class="op"><a href="https://rdatatable.gitlab.io/data.table/reference/chmatch.html" class="external-link">%chin%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Staten Island"</span>, <span class="st">"Unknown"</span>, <span class="st">"EWR"</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>      <span class="op">!</span><span class="va">end_borough</span> <span class="op"><a href="https://rdatatable.gitlab.io/data.table/reference/chmatch.html" class="external-link">%chin%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Staten Island"</span>, <span class="st">"Unknown"</span>, <span class="st">"EWR"</span><span class="op">)</span>, </span>
<span>    <span class="fu">.</span><span class="op">(</span>end_trips <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    by <span class="op">=</span>  <span class="fu">.</span><span class="op">(</span>borough <span class="op">=</span> <span class="va">end_borough</span>, </span>
<span>            zone <span class="op">=</span> <span class="va">end_zone</span><span class="op">)</span></span>
<span>  <span class="op">]</span></span>
<span></span>
<span><span class="co"># 3. Inner Joining Starting and Ending Zones Counts</span></span>
<span><span class="va">JoinedZonesCount</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">StartingZonesCount</span><span class="op">[</span></span>
<span>    <span class="va">EndingZonesCount</span>,</span>
<span>    on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"borough"</span>, <span class="st">"zone"</span><span class="op">)</span>,</span>
<span>    nomatch <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">]</span></span></code></pre></div>
<p>Once we have a much simpler data to work with, we is easy to confirm
with the next linear regression that <code>start_trips</code> and
<code>end_trips</code> has almost the same values the model has an slope
of one. That means that in must of cases <strong>if someone takes a taxi
to go to any place it’s really likely to take another taxi
back</strong>.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">end_trips</span> <span class="op">~</span> <span class="va">start_trips</span>, </span>
<span>   data <span class="op">=</span> <span class="va">JoinedZonesCount</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = end_trips ~ start_trips, data = JoinedZonesCount)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -386706  -25319    4543   21962 1355753 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) -7713.539  13638.224   -0.57     0.57    </span></span>
<span><span class="co">#&gt; start_trips     1.008      0.011   91.75   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 136000 on 216 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.975,  Adjusted R-squared:  0.975 </span></span>
<span><span class="co">#&gt; F-statistic: 8.42e+03 on 1 and 216 DF,  p-value: &lt;2e-16</span></span></code></pre></div>
<p>Let’s now explore the zones where there is <strong>no
balance</strong> between the <code>start_trips</code> and the
<code>end_trips</code> in the most visited zoned of each Borough. To do
so, we defined the rate <code>end_trips</code>/<code>start_trips</code>
and highlight zones with lower rate than the 15% percentile or higher
rate than 85% percentile.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Creating dataset to plot</span></span>
<span><span class="va">ZonesCountToPlot</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">JoinedZonesCount</span><span class="op">)</span><span class="op">[</span></span>
<span>    j <span class="op">=</span> <span class="fu">`:=`</span><span class="op">(</span>ending_starting_rate <span class="op">=</span> <span class="va">end_trips</span><span class="op">/</span><span class="va">start_trips</span>,</span>
<span>             borough <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_reorder.html" class="external-link">fct_reorder</a></span><span class="op">(</span><span class="va">borough</span>, <span class="op">-</span><span class="va">end_trips</span>, .fun <span class="op">=</span> <span class="va">sum</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>             end_m_trips <span class="op">=</span> <span class="va">end_trips</span> <span class="op">/</span> <span class="fl">1e6L</span>,</span>
<span>             start_m_trips <span class="op">=</span> <span class="va">start_trips</span> <span class="op">/</span> <span class="fl">1e6L</span><span class="op">)</span></span>
<span>  <span class="op">]</span><span class="op">[</span>, <span class="va">unbalance_situation</span> <span class="op">:=</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fcase.html" class="external-link">fcase</a></span><span class="op">(</span></span>
<span>    <span class="va">ending_starting_rate</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">ending_starting_rate</span>, <span class="fl">0.15</span><span class="op">)</span>,</span>
<span>    <span class="st">"More starts than ends"</span>,</span>
<span>    <span class="va">ending_starting_rate</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">ending_starting_rate</span>, <span class="fl">0.85</span><span class="op">)</span>,</span>
<span>    <span class="st">"More ends than starts"</span>,</span>
<span>    default <span class="op">=</span> <span class="st">"Balanced"</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="va">start_trips</span> <span class="op">+</span> <span class="va">end_trips</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    <span class="va">.SD</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>,</span>
<span>    by <span class="op">=</span> <span class="st">"borough"</span><span class="op">]</span> </span>
<span></span>
<span><span class="co"># Creating the scatted plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">ZonesCountToPlot</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">start_m_trips</span>, <span class="va">end_m_trips</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_blank.html" class="external-link">geom_blank</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">start_m_trips</span>, <span class="va">end_m_trips</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">start_m_trips</span>, <span class="va">end_m_trips</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">borough</span><span class="op">)</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">3.5</span>,</span>
<span>             alpha <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ZonesCountToPlot</span><span class="op">[</span><span class="va">unbalance_situation</span> <span class="op">==</span></span>
<span>                                      <span class="st">"More starts than ends"</span><span class="op">]</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">zone</span><span class="op">)</span>,</span>
<span>            size <span class="op">=</span> <span class="fl">3.5</span>,</span>
<span>            hjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.12</span>,</span>
<span>            check_overlap <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ZonesCountToPlot</span><span class="op">[</span><span class="va">unbalance_situation</span> <span class="op">==</span></span>
<span>                                      <span class="st">"More ends than starts"</span><span class="op">]</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">zone</span><span class="op">)</span>,</span>
<span>            size <span class="op">=</span> <span class="fl">3.5</span>,</span>
<span>            hjust <span class="op">=</span> <span class="fl">1.12</span>,</span>
<span>            check_overlap <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/comma.html" class="external-link">comma_format</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="fl">0.1</span>, suffix <span class="op">=</span> <span class="st">" M"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/comma.html" class="external-link">comma_format</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="fl">0.1</span>, suffix <span class="op">=</span> <span class="st">" M"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_equal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Top 6 Most Important Zones by Borough"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Borough"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Number of Trips Starting"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Number of Trips Ending"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>        text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span>
<span>        plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="03-data-understanding_files/figure-html/unnamed-chunk-54-1.png" width="700"></p>
<p>Based on the results, we can highlight the next points:</p>
<ol style="list-style-type: decimal">
<li><p>The airports present in Queens, <em>LaGuardia Airport</em> and
<em>JFK Airport</em>, have many more trips going to the airport than
going out of airport. This might happen due that there are more
transportation options like other taxis, shuttles, and public
transportation.</p></li>
<li><p>The remaining zones, <em>Jackson Heights</em>, <em>East
Village</em> and <em>TriBeCa/Civic Center</em>, are residential zones
with a variety of public transportation options.</p></li>
</ol>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://angelfeliz.com" class="external-link">Angel Feliz</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
